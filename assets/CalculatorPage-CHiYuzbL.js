var ce=Object.defineProperty,de=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var K=(r,s,t)=>s in r?ce(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,j=(r,s)=>{for(var t in s||(s={}))he.call(s,t)&&K(r,t,s[t]);if(D)for(var t of D(s))me.call(s,t)&&K(r,t,s[t]);return r},N=(r,s)=>de(r,ue(s));var q=(r,s,t)=>K(r,typeof s!="symbol"?s+"":s,t);var S=(r,s,t)=>new Promise((n,o)=>{var l=c=>{try{h(t.next(c))}catch(u){o(u)}},a=c=>{try{h(t.throw(c))}catch(u){o(u)}},h=c=>c.done?n(c.value):Promise.resolve(c.value).then(l,a);h((t=t.apply(r,s)).next())});import{j as e,_ as xe}from"./index-DdFJfe_p.js";import{r as p,R as $}from"./vendor-lM--12k9.js";import{o as H,s as B,a as J,b as X,c as F,n as w,e as pe,d as G,u as fe}from"./forms-DE1HYwwM.js";import{d as be,D as _,g as L,M as P,K as M,f as R,a as Y,b as V,W as ve,N as ge,B as U,u as ye}from"./useCustomRates-BkE_1c7v.js";import{b as we,X as ee,S as je,a as Ne,R as ke,c as Q,d as Se,T as Ce,e as Le,H as Te,f as Ee,M as W,g as Pe}from"./icons-TocFkSjF.js";function te(r,s,t){var h;function n(c,u){var m,i;var d;Object.defineProperty(c,"_zod",{value:(m=c._zod)!=null?m:{},enumerable:!1}),(i=(d=c._zod).traits)!=null||(d.traits=new Set),c._zod.traits.add(r),s(c,u);for(const x in a.prototype)x in c||Object.defineProperty(c,x,{value:a.prototype[x].bind(c)});c._zod.constr=a,c._zod.def=u}const o=(h=t==null?void 0:t.Parent)!=null?h:Object;class l extends o{}Object.defineProperty(l,"name",{value:r});function a(c){var m;var u;const d=t!=null&&t.Parent?new l:this;n(d,c),(m=(u=d._zod).deferred)!=null||(u.deferred=[]);for(const i of d._zod.deferred)i();return d}return Object.defineProperty(a,"init",{value:n}),Object.defineProperty(a,Symbol.hasInstance,{value:c=>{var u,d;return t!=null&&t.Parent&&c instanceof t.Parent?!0:(d=(u=c==null?void 0:c._zod)==null?void 0:u.traits)==null?void 0:d.has(r)}}),Object.defineProperty(a,"name",{value:r}),a}class Me extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Re={};function se(r){return Re}function Oe(r,s){return typeof s=="bigint"?s.toString():s}const re=Error.captureStackTrace?Error.captureStackTrace:(...r)=>{};function O(r){return typeof r=="string"?r:r==null?void 0:r.message}function ne(r,s,t){var o,l,a,h,c,u,d,m,i,x,f;const n=N(j({},r),{path:(o=r.path)!=null?o:[]});if(!r.message){const b=(f=(x=(m=(u=O((h=(a=(l=r.inst)==null?void 0:l._zod.def)==null?void 0:a.error)==null?void 0:h.call(a,r)))!=null?u:O((c=s==null?void 0:s.error)==null?void 0:c.call(s,r)))!=null?m:O((d=t.customError)==null?void 0:d.call(t,r)))!=null?x:O((i=t.localeError)==null?void 0:i.call(t,r)))!=null?f:"Invalid input";n.message=b}return delete n.inst,delete n.continue,s!=null&&s.reportInput||delete n.input,n}const ae=(r,s)=>{r.name="$ZodError",Object.defineProperty(r,"_zod",{value:r._zod,enumerable:!1}),Object.defineProperty(r,"issues",{value:s,enumerable:!1}),Object.defineProperty(r,"message",{get(){return JSON.stringify(s,Oe,2)},enumerable:!0})},_e=te("$ZodError",ae),oe=te("$ZodError",ae,{Parent:Error}),ze=r=>(s,t,n,o)=>{var h;const l=n?Object.assign(n,{async:!1}):{async:!1},a=s._zod.run({value:t,issues:[]},l);if(a instanceof Promise)throw new Me;if(a.issues.length){const c=new((h=o==null?void 0:o.Err)!=null?h:r)(a.issues.map(u=>ne(u,l,se())));throw re(c,o==null?void 0:o.callee),c}return a.value},$e=ze(oe),Ae=r=>(s,t,n,o)=>S(null,null,function*(){var h;const l=n?Object.assign(n,{async:!0}):{async:!0};let a=s._zod.run({value:t,issues:[]},l);if(a instanceof Promise&&(a=yield a),a.issues.length){const c=new((h=o==null?void 0:o.Err)!=null?h:r)(a.issues.map(u=>ne(u,l,se())));throw re(c,o==null?void 0:o.callee),c}return a.value}),Ke=Ae(oe);function Z(r,s){try{var t=r()}catch(n){return s(n)}return t&&t.then?t.then(void 0,s):t}function Fe(r,s){for(var t={};r.length;){var n=r[0],o=n.code,l=n.message,a=n.path.join(".");if(!t[a])if("unionErrors"in n){var h=n.unionErrors[0].errors[0];t[a]={message:h.message,type:h.code}}else t[a]={message:l,type:o};if("unionErrors"in n&&n.unionErrors.forEach(function(d){return d.errors.forEach(function(m){return r.push(m)})}),s){var c=t[a].types,u=c&&c[n.code];t[a]=J(a,s,t,o,u?[].concat(u,n.message):n.message)}r.shift()}return t}function Ie(r,s){for(var t={};r.length;){var n=r[0],o=n.code,l=n.message,a=n.path.join(".");if(!t[a])if(n.code==="invalid_union"){var h=n.errors[0][0];t[a]={message:h.message,type:h.code}}else t[a]={message:l,type:o};if(n.code==="invalid_union"&&n.errors.forEach(function(d){return d.forEach(function(m){return r.push(m)})}),s){var c=t[a].types,u=c&&c[n.code];t[a]=J(a,s,t,o,u?[].concat(u,n.message):n.message)}r.shift()}return t}function Qe(r,s,t){if(t===void 0&&(t={}),function(n){return"_def"in n&&typeof n._def=="object"&&"typeName"in n._def}(r))return function(n,o,l){try{return Promise.resolve(Z(function(){return Promise.resolve(r[t.mode==="sync"?"parse":"parseAsync"](n,s)).then(function(a){return l.shouldUseNativeValidation&&H({},l),{errors:{},values:t.raw?Object.assign({},n):a}})},function(a){if(function(h){return Array.isArray(h==null?void 0:h.issues)}(a))return{values:{},errors:B(Fe(a.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw a}))}catch(a){return Promise.reject(a)}};if(function(n){return"_zod"in n&&typeof n._zod=="object"}(r))return function(n,o,l){try{return Promise.resolve(Z(function(){return Promise.resolve((t.mode==="sync"?$e:Ke)(r,n,s)).then(function(a){return l.shouldUseNativeValidation&&H({},l),{errors:{},values:t.raw?Object.assign({},n):a}})},function(a){if(function(h){return h instanceof _e}(a))return{values:{},errors:B(Ie(a.issues,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw a}))}catch(a){return Promise.reject(a)}};throw new Error("Invalid input: not a Zod schema")}const De=X({shard:G().min(1,"Please select a shard"),quantity:w().min(1,"Quantity must be at least 1"),hunterFortune:w().min(0,"Hunter Fortune must be non-negative"),excludeChameleon:F(),frogPet:F(),newtLevel:w().min(0).max(10),salamanderLevel:w().min(0).max(10),lizardKingLevel:w().min(0).max(10),leviathanLevel:w().min(0).max(10),pythonLevel:w().min(0).max(10),kingCobraLevel:w().min(0).max(10),seaSerpentLevel:w().min(0).max(10),tiamatLevel:w().min(0).max(10),kuudraTier:pe(["none","t1","t2","t3","t4","t5"]),moneyPerHour:w().min(0),noWoodenBait:F()});X({shardId:G(),rate:w().min(0)});const qe=$.memo(({shard:r,index:s,focusedIndex:t,onSelect:n,isSelecting:o,setFocusedIndex:l})=>{const a=p.useCallback(c=>{c.preventDefault(),c.stopPropagation(),n(r)},[n,r]),h=p.useCallback(()=>{o||l(s)},[o,l,s]);return e.jsx("li",{className:`
        px-4 py-3 cursor-pointer transition-colors duration-200
        ${s===t?"bg-purple-500/20 border-l-2 border-purple-500":"hover:bg-white/5"}
        ${s!==t?"border-b border-white/5":""}
      `,onMouseDown:a,onClick:a,onMouseEnter:h,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:`font-medium ${L(r.rarity)}`,children:r.name}),e.jsxs("div",{className:"text-sm text-slate-400",children:[r.family," â€¢ ",r.type]})]}),r.rate>0&&e.jsxs("div",{className:"text-xs text-slate-500",children:[r.rate,"/hr"]})]})})}),He=({value:r,onChange:s,onSelect:t,placeholder:n="Search for a shard...",className:o=""})=>{const[l,a]=p.useState([]),[h,c]=p.useState(!1),[u,d]=p.useState(-1),[m,i]=p.useState(!1),x=p.useRef(null),f=p.useRef(null),b=p.useRef(null),y=p.useMemo(()=>be(v=>S(null,null,function*(){if(v.length===0||m){a([]),c(!1);return}try{const E=yield _.getInstance().searchShards(v);a(E.slice(0,10)),c(E.length>0),d(-1)}catch(g){console.error("Search failed:",g),a([]),c(!1)}}),200),[m]),k=p.useCallback(v=>{const g=v.target.value;i(!1),s(g),b.current&&clearTimeout(b.current),y(g)},[s,y]),T=p.useCallback(v=>{i(!0),c(!1),a([]),d(-1),s(v.name),t(v),b.current&&clearTimeout(b.current),setTimeout(()=>{i(!1),x.current&&x.current.blur()},50)},[s,t]),A=p.useCallback(v=>{if(!(!h||l.length===0||m))switch(v.key){case"ArrowDown":v.preventDefault(),d(g=>(g+1)%l.length);break;case"ArrowUp":v.preventDefault(),d(g=>g<=0?l.length-1:g-1);break;case"Enter":v.preventDefault(),u>=0&&u<l.length?T(l[u]):l.length===1&&T(l[0]);break;case"Escape":c(!1),d(-1);break}},[h,l,m,u,T]),le=p.useCallback(()=>{var v;i(!1),s(""),a([]),c(!1),d(-1),b.current&&clearTimeout(b.current),(v=x.current)==null||v.focus()},[s]),ie=p.useCallback(()=>{m||r&&l.length>0&&(l.some(g=>g.name.toLowerCase()===r.toLowerCase())||c(!0))},[m,r,l]);return p.useEffect(()=>{const v=g=>{const E=g.target;x.current&&!x.current.contains(E)&&f.current&&!f.current.contains(E)&&(c(!1),d(-1))};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v),b.current&&clearTimeout(b.current)}},[]),e.jsxs("div",{className:`relative ${o}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(we,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{ref:x,type:"text",value:r,onChange:k,onKeyDown:A,onFocus:ie,placeholder:n,className:`
            w-full pl-10 pr-10 py-3 
            bg-white/5 border border-white/10 
            rounded-xl text-white placeholder-slate-400
            focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
            transition-colors duration-200
          `,autoComplete:"off",spellCheck:!1}),r&&e.jsx("button",{onClick:le,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-white transition-colors duration-200",children:e.jsx(ee,{className:"h-5 w-5"})})]}),h&&l.length>0&&!m&&e.jsx("ul",{ref:f,className:`
            absolute z-50 w-full mt-2 
            bg-slate-800/90 backdrop-blur-performance
            border border-white/10 
            rounded-xl shadow-2xl
            max-h-64 overflow-y-auto
            contain-paint
          `,children:l.map((v,g)=>e.jsx(qe,{shard:v,index:g,focusedIndex:u,onSelect:T,isSelecting:m,setFocusedIndex:d},v.key))})]})},Be=$.memo(({value:r,onChange:s,label:t})=>{const[n,o]=p.useState(!1),l=p.useMemo(()=>Array.from({length:11},(u,d)=>d),[]),a=p.useCallback(u=>{u.target.closest(".pet-level-dropdown")||o(!1)},[]);p.useEffect(()=>{if(n)return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[n,a]);const h=p.useCallback(()=>o(!n),[]),c=p.useCallback(u=>{s(u),o(!1)},[s]);return e.jsxs("div",{className:"relative pet-level-dropdown",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-0.5",children:t}),e.jsxs("button",{type:"button",onClick:h,className:`
          w-full px-2 py-1.5 text-xs
          bg-white/5 backdrop-blur-performance
          border border-white/10 
          rounded-lg text-white
          focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
          hover:bg-white/10 transition-colors-only
          flex items-center justify-between
        `,children:[e.jsx("span",{children:r}),e.jsx(Q,{className:`w-3 h-3 transition-transform duration-200 ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:`
            absolute z-50 w-full mt-1
            bg-slate-800/95 backdrop-blur-performance
            border border-white/10 
            rounded-lg shadow-2xl
            max-h-48 overflow-y-auto
            contain-paint
          `,children:l.map(u=>e.jsxs("button",{type:"button",onClick:()=>c(u),className:`
                w-full px-2 py-1.5 text-xs text-left
                hover:bg-purple-500/20 transition-colors-only
                ${r===u?"bg-purple-500/30 text-purple-300":"text-white"}
                ${u!==l.length-1?"border-b border-white/5":""}
              `,children:["Level ",u]},u))})]})}),Ve=$.memo(({value:r,onChange:s,label:t})=>{const[n,o]=p.useState(!1),l=p.useCallback(u=>{u.target.closest(".kuudra-dropdown")||o(!1)},[]);p.useEffect(()=>{if(n)return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[n,l]);const a=p.useCallback(()=>o(!n),[]),h=p.useCallback(u=>{s(u),o(!1)},[s]),c=p.useMemo(()=>M.find(u=>u.value===r),[r]);return e.jsxs("div",{className:"relative kuudra-dropdown",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:t}),e.jsxs("button",{type:"button",onClick:a,className:`
          w-full px-2 py-1.5 text-sm
          bg-white/5 backdrop-blur-performance
          border border-white/10 
          rounded-lg text-white
          focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
          hover:bg-white/10 transition-colors-only
          flex items-center justify-between
        `,children:[e.jsx("span",{children:(c==null?void 0:c.label)||r}),e.jsx(Q,{className:`w-3 h-3 transition-transform duration-200 ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:`
            absolute z-50 w-full mt-1
            bg-slate-800/95 backdrop-blur-performance
            border border-white/10 
            rounded-lg shadow-2xl
            max-h-48 overflow-y-auto
            contain-paint
          `,children:M.map(u=>e.jsx("button",{type:"button",onClick:()=>h(u.value),className:`
                w-full px-2 py-1.5 text-xs text-left
                hover:bg-purple-500/20 transition-colors-only
                ${r===u.value?"bg-purple-500/30 text-purple-300":"text-white"}
                ${u!==M[M.length-1]?"border-b border-white/5":""}
              `,children:u.label},u.value))})]})}),Ue=({onSubmit:r})=>{const{register:s,setValue:t,watch:n,reset:o,formState:{errors:l}}=fe({resolver:Qe(De),defaultValues:{shard:"",quantity:1,hunterFortune:0,excludeChameleon:!1,frogPet:!1,newtLevel:0,salamanderLevel:0,lizardKingLevel:0,leviathanLevel:0,pythonLevel:0,kingCobraLevel:0,seaSerpentLevel:0,tiamatLevel:0,kuudraTier:"t5",moneyPerHour:0,noWoodenBait:!1}}),a=n("shard"),h=n();p.useEffect(()=>{const i=x=>S(null,null,function*(){if(!x||x.trim()==="")return!1;try{return!!(yield _.getInstance().getShardNameToKeyMap())[x.toLowerCase()]}catch(f){return!1}});if(a&&a.trim()!==""&&h.shard&&h.shard.trim()!==""){const x=setTimeout(()=>S(null,null,function*(){if(yield i(h.shard)){const b=h,y=N(j({},b),{frogPet:!b.frogPet});r(y)}}),1e3);return()=>clearTimeout(x)}},[h,r,a]);const c=i=>{t("shard",i.name),setTimeout(()=>{const x=n(),f=N(j({},x),{shard:i.name,frogPet:!x.frogPet});r(f)},100)},u=()=>{t("hunterFortune",121),t("newtLevel",10),t("salamanderLevel",10),t("lizardKingLevel",10),t("leviathanLevel",10),t("pythonLevel",10),t("kingCobraLevel",10),t("seaSerpentLevel",10),t("tiamatLevel",10)},d=()=>{const i=n("shard"),x=n("quantity");o(),t("shard",i),t("quantity",x)},m=()=>S(null,null,function*(){const i=a;if(!i||i.trim()===""){t("quantity",P.common);return}try{const f=yield _.getInstance().getShardByName(i);if(f){const b=P[f.rarity]||P.common;t("quantity",b)}else t("quantity",P.common)}catch(x){console.error("Failed to get shard rarity:",x),t("quantity",P.common)}});return e.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-3",children:e.jsxs("form",{onSubmit:i=>i.preventDefault(),className:"space-y-3",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Target Shard"}),e.jsx(He,{value:a,onChange:i=>t("shard",i),onSelect:c,placeholder:"Search for a shard..."}),l.shard&&e.jsx("p",{className:"mt-1 text-xs text-red-400",children:l.shard.message})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Quantity"}),e.jsx("input",N(j({type:"number",min:"1"},s("quantity",{valueAsNumber:!0})),{onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),i.currentTarget.blur())},className:`
                  w-full px-2 py-1.5 text-sm
                  bg-white/5 backdrop-blur-xl 
                  border border-white/10 
                  rounded-lg text-white placeholder-slate-400
                  focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                  transition-all duration-200
                `})),l.quantity&&e.jsx("p",{className:"mt-1 text-xs text-red-400",children:l.quantity.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Â "}),e.jsx("button",{type:"button",onClick:m,className:`
                    w-full h-[34px] text-sm bg-gradient-to-r from-blue-500 to-purple-500 
                    text-white font-medium rounded-lg flex items-center justify-center
                    hover:from-blue-600 hover:to-purple-600
                    transition-all duration-200 cursor-pointer
                    hover:scale-[1.02] active:scale-[0.98]
                  `,children:"Max"})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"w-3 h-3 text-purple-400"}),e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Settings"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:u,className:`
                h-8 px-3 bg-gradient-to-r from-yellow-500 to-orange-500 
                text-white font-medium rounded-lg text-xs
                hover:from-yellow-600 hover:to-orange-600
                transition-all duration-200 flex items-center justify-center space-x-1 cursor-pointer
                hover:scale-[1.02] active:scale-[0.98]
              `,children:[e.jsx(Ne,{className:"w-3 h-3"}),e.jsx("span",{children:"Max Stats"})]}),e.jsxs("button",{type:"button",onClick:d,className:`
                h-8 px-3 bg-gradient-to-r from-rose-500 to-pink-500 
                text-white font-medium rounded-lg text-xs
                hover:from-rose-600 hover:to-pink-600
                transition-all duration-200 flex items-center justify-center space-x-1 cursor-pointer
                hover:scale-[1.02] active:scale-[0.98]
              `,children:[e.jsx(ke,{className:"w-3 h-3"}),e.jsx("span",{children:"Reset"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Hunter Fortune"}),e.jsx("input",N(j({type:"number",min:"0"},s("hunterFortune",{valueAsNumber:!0})),{onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),i.currentTarget.blur())},className:`
                  w-full px-2 py-1.5 text-sm
                  bg-white/5 backdrop-blur-xl 
                  border border-white/10 
                  rounded-lg text-white placeholder-slate-400
                  focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                  transition-all duration-200
                `}))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 items-center space-x-2 p-2 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-all duration-200",children:[e.jsx("input",N(j({id:"excludeChameleon",type:"checkbox"},s("excludeChameleon")),{className:`
                    w-4 h-4 rounded-md bg-white/5 border-2 border-white/20 
                    text-purple-500 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500
                    transition-all duration-200 cursor-pointer
                    checked:bg-purple-500 checked:border-purple-500
                  `})),e.jsx("label",{htmlFor:"excludeChameleon",className:"text-xs font-medium text-white cursor-pointer flex-1",children:"Exclude Chameleon"})]}),e.jsxs("div",{className:"flex gap-2 items-center space-x-2 p-2 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-all duration-200",children:[e.jsx("input",N(j({id:"excludeWoodenBait",type:"checkbox"},s("noWoodenBait")),{className:`
                    w-4 h-4 rounded-md bg-white/5 border-2 border-white/20 
                    text-purple-500 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500
                    transition-all duration-200 cursor-pointer
                    checked:bg-purple-500 checked:border-purple-500
                  `})),e.jsx("label",{htmlFor:"excludeWoodenBait",className:"text-xs font-medium text-white cursor-pointer flex-1",children:"Exclude Wooden Bait"})]}),e.jsxs("div",{className:"flex gap-2 items-center space-x-2 p-2 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-all duration-200",children:[e.jsx("input",N(j({id:"frogPet",type:"checkbox"},s("frogPet")),{className:`
                    w-4 h-4 rounded-md bg-white/5 border-2 border-white/20 
                    text-purple-500 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500
                    transition-all duration-200 cursor-pointer
                    checked:bg-purple-500 checked:border-purple-500
                  `})),e.jsx("label",{htmlFor:"frogPet",className:"text-xs font-medium text-white cursor-pointer flex-1",children:"No Frog Pet"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Shard Levels"}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:[{key:"newtLevel",label:"Newt"},{key:"salamanderLevel",label:"Salamander"},{key:"lizardKingLevel",label:"Lizard King"},{key:"leviathanLevel",label:"Leviathan"},{key:"pythonLevel",label:"Python"},{key:"kingCobraLevel",label:"King Cobra"},{key:"seaSerpentLevel",label:"Sea Serpent"},{key:"tiamatLevel",label:"Tiamat"}].map(({key:i,label:x})=>e.jsx(Be,{value:n(i)||0,onChange:f=>t(i,f),label:x},i))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Kraken Shard"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ve,{value:n("kuudraTier")||"t5",onChange:i=>t("kuudraTier",i),label:"Kuudra Tier"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Coins/hour"}),e.jsx("input",N(j({type:"number",min:"0",placeholder:"40000000"},s("moneyPerHour",{valueAsNumber:!0})),{onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),i.currentTarget.blur())},className:`
                  w-full px-2 py-1.5 text-sm
                  bg-white/5 backdrop-blur-xl 
                  border border-white/10 
                  rounded-lg text-white placeholder-slate-400
                  focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                  transition-all duration-200
                `})),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Empty to ignore key cost"})]})]})]})]})})},I=({tree:r,data:s,isTopLevel:t=!1,totalShardsProduced:n=r.quantity,nodeId:o,expandedStates:l,onToggle:a})=>{var f;const h=s.shards[r.shard],c=(f=l.get(o))!=null?f:!0;if(r.method==="direct")return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-slate-400",children:[r.quantity,"x"]}),e.jsx("span",{className:`font-medium cursor-help ${L(h.rarity)}`,title:V(h,!0),children:h.name}),e.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs font-medium rounded-full border border-green-500/30",children:"direct"})]})]}),e.jsxs("div",{className:"text-right flex flex-col items-end space-y-1",children:[e.jsxs("div",{className:"text-xs text-slate-400",children:[Y(h.rate),"/hour"]}),e.jsxs("div",{className:"text-xs text-slate-500 capitalize",children:[h.type," â€¢ ",h.family]})]})]});const u=r.inputs[0],d=r.inputs[1],m=s.shards[u.shard],i=s.shards[d.shard],x=t?n:r.quantity;return e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 overflow-hidden",children:[e.jsx("button",{onClick:()=>a(o),className:"w-full p-4 text-left hover:bg-white/5 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[c?e.jsx(Q,{className:"w-5 h-5 text-slate-400"}):e.jsx(Ee,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{className:"text-white",children:[e.jsxs("span",{className:"font-semibold",children:[x,"x "]}),e.jsx("span",{className:`font-medium cursor-help ${L(h.rarity)}`,title:V(h,!1),children:h.name}),e.jsxs("span",{className:"text-slate-400 ml-2",children:["= ",u.quantity,"x ",e.jsx("span",{className:L(m.rarity),children:m.name})," + ",d.quantity,"x"," ",e.jsx("span",{className:L(i.rarity),children:i.name})]})]})]}),e.jsxs("div",{className:"text-right flex flex-col items-end space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"fusions"}),e.jsx("span",{className:"text-sm font-medium text-white",children:x})]}),e.jsxs("div",{className:"text-xs text-slate-400 capitalize",children:[h.type," â€¢ ",h.family]})]})]})}),c&&e.jsxs("div",{className:"border-t border-white/10 p-4 space-y-3",children:[e.jsx(I,{tree:u,data:s,nodeId:`${o}-0`,expandedStates:l,onToggle:a}),e.jsx(I,{tree:d,data:s,nodeId:`${o}-1`,expandedStates:l,onToggle:a})]})]})},We=({result:r,data:s,targetShardName:t})=>{const[n,o]=p.useState(new Map),[l,a]=p.useState(""),h=(d,m="root")=>{const i=new Map,x=(f,b)=>{f.method==="recipe"&&f.inputs&&(i.set(b,!0),f.inputs.forEach((y,k)=>{x(y,`${b}-${k}`)}))};return x(d,m),i};$.useEffect(()=>{if(r.tree){const d=JSON.stringify(r.tree);if(d!==l){const m=h(r.tree);o(m),a(d)}}},[r.tree,l]);const c=()=>{const d=new Map(n),m=Array.from(d.values()).every(i=>i);for(const i of d.keys())d.set(i,!m);o(d)},u=d=>{const m=new Map(n);m.set(d,!m.get(d)),o(m)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-purple-500/10 to-blue-500/10 backdrop-blur-xl border border-purple-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Se,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Time per Shard"}),e.jsx("p",{className:"text-white font-semibold",children:R(r.timePerShard)})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-500/10 to-cyan-500/10 backdrop-blur-xl border border-blue-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Ce,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Total Time"}),e.jsx("p",{className:"text-white font-semibold",children:R(r.totalTime)})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500/10 to-emerald-500/10 backdrop-blur-xl border border-green-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Le,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Shards Produced"}),e.jsx("p",{className:"text-white font-semibold",children:r.totalShardsProduced})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 backdrop-blur-xl border border-orange-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Te,{className:"w-5 h-5 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Total Fusions"}),e.jsxs("p",{className:"text-white font-semibold",children:[r.totalFusions,"x",r.craftTime>1/12&&e.jsx("span",{className:"text-xs text-slate-400 block",children:R(r.craftTime)})]})]})]})})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Materials Needed"}),e.jsxs("div",{className:"text-sm text-slate-400",children:["for ",r.totalShardsProduced," ",t," (",r.craftsNeeded," craft",r.craftsNeeded>1?"s":"",")"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Array.from(r.totalQuantities).map(([d,m])=>{const i=s.shards[d],x=m/i.rate;return e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[m,"x ",e.jsx("span",{className:L(i.rarity),children:i.name})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[Y(i.rate),"/hour"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-xs text-slate-400",children:R(x)})})]})},d)})})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Fusion Tree"}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors duration-200",children:Array.from(n.values()).every(d=>d)?"Collapse All":"Expand All"})]}),e.jsx(I,{tree:r.tree,data:s,isTopLevel:!0,totalShardsProduced:r.totalShardsProduced,nodeId:"root",expandedStates:n,onToggle:u})]})]})},C=class C{static getInstance(){return C.instance||(C.instance=new C),C.instance}parseData(s){return S(this,null,function*(){var t,n;try{const[o,l]=yield Promise.all([fetch("/SkyShards/fusion-data.json"),fetch("/SkyShards/rates.json")]),a=yield o.json(),h=yield l.json(),c={};for(const d in a.recipes){c[d]=[];for(const m in a.recipes[d]){const i=parseInt(m);a.recipes[d][m].forEach(f=>{c[d].push({inputs:f,outputQuantity:i})})}}const u={};for(const d in a.shards){let m=(n=(t=s.customRates[d])!=null?t:h[d])!=null?n:0;d==="L15"&&m===0&&(m=this.calculateKuudraRate(s.kuudraTier,s.moneyPerHour)),m>0&&(s.noWoodenBait&&ve.includes(d)&&(m*=.05),ge.includes(d)||(m=this.applyFortuneModifiers(m,d,a.shards[d],s))),s.excludeChameleon&&d==="L4"&&(m=0),u[d]=N(j({},a.shards[d]),{id:d,rate:m})}return{recipes:c,shards:u}}catch(o){throw new Error(`Failed to parse data: ${o}`)}})}calculateKuudraRate(s,t){const o={t1:{baseTime:135,cost:155e3,multiplier:1},t2:{baseTime:135,cost:31e4,multiplier:1},t3:{baseTime:135,cost:582e3,multiplier:2},t4:{baseTime:135,cost:1164e3,multiplier:2},t5:{baseTime:165,cost:2328e3,multiplier:3}}[s];if(!o)return 0;const l=t===0?0:o.cost/t*3600;return o.multiplier*(3600/(o.baseTime+l))}applyFortuneModifiers(s,t,n,o){let l=o.hunterFortune;const a=1+5*o.tiamatLevel/100,h=1+2*o.seaSerpentLevel/100*a,c=2*o.pythonLevel/100*h,u=o.kingCobraLevel/100*h;switch(n.rarity){case"common":l+=2*o.newtLevel;break;case"uncommon":l+=2*o.salamanderLevel;break;case"rare":l+=o.lizardKingLevel;break;case"epic":l+=o.leviathanLevel;break}return o.frogPet&&(s*=1.1),t in U&&(U[t]&&(s*=1+c),l*=1+u),s*(1+l/100)}computeMinCosts(s){const t=new Map,n=new Map,o=Object.keys(s.shards);o.forEach(a=>{const h=s.shards[a].rate>0?1/s.shards[a].rate:1/0;t.set(a,h),n.set(a,{recipe:null})});let l=!0;for(;l;)l=!1,o.forEach(a=>{(s.recipes[a]||[]).forEach(c=>{const[u,d]=c.inputs,m=s.shards[u].fuse_amount,i=s.shards[d].fuse_amount,x=t.get(u)*m,f=t.get(d)*i,b=.8/3600,k=(x+f+b)/c.outputQuantity;k<t.get(a)&&(t.set(a,k),n.set(a,{recipe:c}),l=!0)})});return{minCosts:t,choices:n}}buildRecipeTree(s,t){const n=t.get(s);if(n.recipe===null)return{shard:s,method:"direct",quantity:0};{const o=n.recipe,[l,a]=o.inputs,h=this.buildRecipeTree(l,t),c=this.buildRecipeTree(a,t);return{shard:s,method:"recipe",recipe:o,inputs:[h,c],quantity:0}}}assignQuantities(s,t,n,o){if(s.quantity=t,s.method==="recipe"){const l=s.recipe,a=l.outputQuantity,h=Math.ceil(t/a);o.total+=h;const[c,u]=l.inputs,d=n.shards[c].fuse_amount,m=n.shards[u].fuse_amount,i=h*d,x=h*m;this.assignQuantities(s.inputs[0],i,n,o),this.assignQuantities(s.inputs[1],x,n,o)}}collectTotalQuantities(s){const t=new Map,n=o=>{if(o.method==="direct"){const l=t.get(o.shard)||0;t.set(o.shard,l+o.quantity)}else o.inputs.forEach(n)};return n(s),t}decimalHoursToHoursMinutes(s){const t=Math.floor(s),n=Math.round((s-t)*60);return t===0?`${n} minutes`:n===0||isNaN(n)?`${t} hours`:`${t} hours ${n} minutes`}calculateOptimalPath(s,t,n){return S(this,null,function*(){var y;const o=yield this.parseData(n);if(!o.shards[s])return{timePerShard:0,totalTime:0,totalShardsProduced:0,craftsNeeded:0,totalQuantities:new Map,totalFusions:0,craftTime:0,tree:{shard:s,method:"direct",quantity:0,inputs:[]}};const{minCosts:l,choices:a}=this.computeMinCosts(o),h=this.buildRecipeTree(s,a),c={total:0};this.assignQuantities(h,t,o,c);const u=this.collectTotalQuantities(h);let d=t,m=1;const i=a.get(s);if(i!=null&&i.recipe){const k=i.recipe.outputQuantity;m=Math.ceil(t/k),d=m*k}const x=(y=l.get(s))!=null?y:0,f=x*d,b=c.total*.8/3600;return{timePerShard:x,totalTime:f,totalShardsProduced:d,craftsNeeded:m,totalQuantities:u,totalFusions:c.total,craftTime:b,tree:h}})}};q(C,"instance");let z=C;const Ze=Object.freeze(Object.defineProperty({__proto__:null,CalculationService:z},Symbol.toStringTag,{value:"Module"})),Je=()=>{const[r,s]=p.useState(null),[t,n]=p.useState(!1),[o,l]=p.useState(null),a=p.useCallback((c,u,d)=>S(null,null,function*(){try{n(!0),l(null);const i=yield z.getInstance().calculateOptimalPath(c,u,d);s(i)}catch(m){l(m instanceof Error?m.message:"Calculation failed"),s(null)}finally{n(!1)}}),[]),h=p.useCallback(()=>{s(null),l(null)},[]);return{result:r,loading:t,error:o,calculate:a,clearResult:h}},rt=()=>{const{result:r,loading:s,error:t,calculate:n}=Je(),{customRates:o}=ye(),[l,a]=p.useState(null),[h,c]=p.useState(""),[u,d]=p.useState(!1),m=i=>S(null,null,function*(){try{if(!i.shard||i.shard.trim()===""){console.warn("Calculation skipped: No shard selected");return}d(!1);const b=(yield _.getInstance().getShardNameToKeyMap())[i.shard.toLowerCase()];if(!b){console.warn(`Calculation skipped: Shard "${i.shard}" not found in data`);return}c(i.shard);const y={customRates:o,hunterFortune:i.hunterFortune,excludeChameleon:i.excludeChameleon,frogPet:i.frogPet,newtLevel:i.newtLevel,salamanderLevel:i.salamanderLevel,lizardKingLevel:i.lizardKingLevel,leviathanLevel:i.leviathanLevel,pythonLevel:i.pythonLevel,kingCobraLevel:i.kingCobraLevel,seaSerpentLevel:i.seaSerpentLevel,tiamatLevel:i.tiamatLevel,kuudraTier:i.kuudraTier,moneyPerHour:i.moneyPerHour,noWoodenBait:i.noWoodenBait};yield n(b,i.quantity,y);const A=yield(yield xe(()=>Promise.resolve().then(()=>Ze),void 0)).CalculationService.getInstance().parseData(y);a(A)}catch(x){x instanceof Error&&!x.message.includes("not found")&&console.error("Calculation failed:",x)}});return e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 xl:gap-6 h-full",children:[e.jsx("div",{className:"xl:hidden",children:e.jsxs("button",{onClick:()=>d(!u),className:`
            mb-4 px-4 py-2 bg-white/5 backdrop-blur-xl 
            border border-white/10 rounded-xl text-white
            hover:bg-white/10 transition-all duration-200
            flex items-center space-x-2
            hover:scale-[1.02] active:scale-[0.98]
          `,children:[u?e.jsx(ee,{className:"w-4 h-4"}):e.jsx(W,{className:"w-4 h-4"}),e.jsxs("span",{children:[u?"Hide":"Show"," Configuration"]})]})}),e.jsx("div",{className:`xl:w-80 2xl:w-96 xl:flex-shrink-0 ${u?"block":"hidden xl:block"}`,children:e.jsx("div",{children:e.jsx(Ue,{onSubmit:m})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[t&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4 flex items-center space-x-3 mb-6",children:[e.jsx(Pe,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-400",children:"Calculation Error"}),e.jsx("p",{className:"text-red-300 text-sm",children:t})]})]}),r&&l&&e.jsx(We,{result:r,data:l,targetShardName:h}),!r&&!s&&!t&&e.jsxs("div",{className:"text-center py-16 bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:"Ready to Calculate"}),e.jsxs("p",{className:"text-slate-400 max-w-md mx-auto",children:["Configure your settings ",e.jsx("span",{className:"xl:hidden",children:"above"}),e.jsx("span",{className:"hidden xl:inline",children:"on the left"})," and select a shard to see optimal fusion paths and material costs"]}),e.jsx("div",{className:"xl:hidden mt-4",children:e.jsxs("button",{onClick:()=>d(!0),className:`
                  px-6 py-3 bg-gradient-to-r from-purple-500 to-blue-600 
                  text-white font-medium rounded-xl 
                  hover:from-purple-600 hover:to-blue-700
                  transition-all duration-200
                  flex items-center space-x-2 mx-auto
                  hover:scale-[1.02] active:scale-[0.98]
                `,children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Open Configuration"})]})})]})]})]})};export{rt as CalculatorPage};
