var pe=Object.defineProperty,fe=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var G=(u,t,c)=>t in u?pe(u,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):u[t]=c,K=(u,t)=>{for(var c in t||(t={}))ye.call(t,c)&&G(u,c,t[c]);if(re)for(var c of re(t))ge.call(t,c)&&G(u,c,t[c]);return u},H=(u,t)=>fe(u,be(t));var ie=(u,t,c)=>G(u,typeof t!="symbol"?t+"":t,c);var O=(u,t,c)=>new Promise((d,l)=>{var o=h=>{try{m(c.next(h))}catch(x){l(x)}},r=h=>{try{m(c.throw(h))}catch(x){l(x)}},m=h=>h.done?d(h.value):Promise.resolve(h.value).then(o,r);m((c=c.apply(u,t)).next())});import{d as ve,j as e,S as je,u as te,M as le,P as Ne,c as we,K as Se,f as J,g as Ce,a as z,b as V,W as ke,N as Le,B as ce,_ as oe}from"./index-vjziEOS2.js";import{r as N,R as U}from"./vendor-e8ACzjHW.js";import{D as X,u as Re}from"./useCustomRates-CJNNvsyl.js";import{b as Te,X as xe,S as Pe,Z as Ee,R as Me,M as $e,a as Qe,c as Fe,d as Oe,T as _e,e as de,H as ue,f as me,g as Ke}from"./icons-DR3cHNnz.js";import"./forms-B7jjzPDX.js";const He={newtLevel:{title:"Newt",description:"Provides +2 Hunter Fortune per level towards COMMON rarity shards",rarity:"common",shardIcon:"C35"},salamanderLevel:{title:"Salamander",description:"Provides +2 Hunter Fortune per level towards UNCOMMON rarity shards",rarity:"uncommon",shardIcon:"U8"},lizardKingLevel:{title:"Lizard King",description:"Provides +1 Hunter Fortune per level towards RARE rarity shards",rarity:"rare",shardIcon:"R8"},leviathanLevel:{title:"Leviathan",description:"Provides +1 Hunter Fortune per level towards EPIC rarity shards",rarity:"epic",shardIcon:"E5"},pythonLevel:{title:"Python",description:"Provides +2% rate bonus per level for Black Hole shards (affected by Sea Serpent multiplier)",rarity:"rare",shardIcon:"R9"},kingCobraLevel:{title:"King Cobra",description:"Provides +1% fortune multiplier per level for Black Hole shards (affected by Sea Serpent multiplier)",rarity:"rare",shardIcon:"R56"},seaSerpentLevel:{title:"Sea Serpent",description:"Provides +2% rate multiplier per level that enhances Python and King Cobra bonuses (affected by Tiamat multiplier)",rarity:"epic",shardIcon:"E32"},tiamatLevel:{title:"Tiamat",description:"Provides +5% rate multiplier per level that enhances Sea Serpent bonuses",rarity:"legendary",shardIcon:"L6"},crocodileLevel:{title:"Crocodile",description:"Provides +2% rate multiplier per level for Reptile shards (affected by Sea Serpent multiplier)",warning:"Warning: May slow calculations significantly",rarity:"rare",shardIcon:"R45"}};function Ie(u){return O(this,null,function*(){return!u||typeof u!="string"?!1:!!(yield X.getInstance().getShardNameToKeyMap())[u.trim().toLowerCase()]})}const ze=({value:u,onChange:t,onSelect:c,onFocus:d,placeholder:l="Search for a shard...",className:o=""})=>{const[r,m]=N.useState([]),[h,x]=N.useState(!1),[s,a]=N.useState(-1),[i,n]=N.useState(!1),[f,b]=N.useState(!1),g=N.useRef(null),j=N.useRef(null),w=N.useRef(null),L=N.useMemo(()=>ve(p=>O(null,null,function*(){if(p.length===0||i){m([]),x(!1),b(!1);return}b(!0);try{const S=yield X.getInstance().searchShards(p);m(S.slice(0,10)),x(S.length>0),a(-1)}catch(y){console.error("Search failed:",y),m([]),x(!1)}finally{b(!1)}}),100),[i]),E=N.useCallback(p=>{const y=p.target.value;n(!1),t(y),w.current&&clearTimeout(w.current),L(y)},[t,L]),k=N.useCallback(p=>{n(!0),x(!1),m([]),a(-1),t(p.name),c(p),w.current&&clearTimeout(w.current),setTimeout(()=>{n(!1),g.current&&g.current.blur()},50)},[t,c]),$=N.useCallback(p=>{if(!(!h||r.length===0||i))switch(p.key){case"ArrowDown":p.preventDefault(),a(y=>(y+1)%r.length);break;case"ArrowUp":p.preventDefault(),a(y=>y<=0?r.length-1:y-1);break;case"Enter":p.preventDefault(),s>=0&&s<r.length?k(r[s]):r.length===1&&k(r[0]);break;case"Escape":x(!1),a(-1);break}},[h,r,i,s,k]),_=N.useCallback(()=>{var p;n(!1),t(""),m([]),x(!1),a(-1),w.current&&clearTimeout(w.current),(p=g.current)==null||p.focus()},[t]),v=N.useCallback(()=>{i||u.trim()&&L(u)},[i,u,L]);return N.useEffect(()=>{const p=y=>{const S=y.target;g.current&&!g.current.contains(S)&&j.current&&!j.current.contains(S)&&(x(!1),a(-1))};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p),w.current&&clearTimeout(w.current)}},[]),e.jsxs("div",{className:`relative ${o}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f?e.jsx("div",{className:"w-4 h-4 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}):e.jsx(Te,{className:"h-4 w-4 text-slate-400"})}),e.jsx("input",{ref:g,type:"text",value:u,onChange:E,onKeyDown:$,onFocus:()=>{d&&d(),v()},placeholder:l,className:"w-full pl-10 pr-10 py-2.5 bg-slate-800 border border-slate-600 rounded-md text-white placeholder-slate-400 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500/20 hover:border-slate-500 transition-colors",autoComplete:"off",spellCheck:!1}),u&&e.jsx("button",{onClick:_,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-white",children:e.jsx(xe,{className:"h-4 w-4"})})]}),h&&r.length>0&&!i&&e.jsx("ul",{ref:j,className:"absolute z-50 w-full mt-1 bg-slate-800 border border-slate-600 rounded-md shadow-xl max-h-60 overflow-y-auto",children:r.map((p,y)=>e.jsx(je,{shard:p,index:y,focusedIndex:s,onSelect:k,isSelecting:i,setFocusedIndex:a},p.key))})]})},We=({onSubmit:u})=>{const{form:t,setForm:c}=te();U.useEffect(()=>{O(null,null,function*(){t.shard&&t.shard.trim()!==""&&(yield Ie(t.shard))&&u(H(K({},t),{frogPet:!1}))})},[t.shard,t.quantity]);const d=(s,a)=>{const i=H(K({},t),{[s]:a});c(i),s!=="shard"&&s!=="quantity"&&u(i)},l=()=>{const s=H(K({},t),{hunterFortune:121,newtLevel:10,salamanderLevel:10,lizardKingLevel:10,leviathanLevel:10,pythonLevel:10,kingCobraLevel:10,seaSerpentLevel:10,tiamatLevel:10,crocodileLevel:10,kuudraTier:"t5"});c(s),setTimeout(()=>{u(s)},0)},o=()=>{const s=t.shard,a=t.quantity,i={shard:s,quantity:a,hunterFortune:0,excludeChameleon:!1,frogPet:!1,newtLevel:0,salamanderLevel:0,lizardKingLevel:0,leviathanLevel:0,pythonLevel:0,kingCobraLevel:0,seaSerpentLevel:0,tiamatLevel:0,crocodileLevel:0,kuudraTier:"none",moneyPerHour:1/0,noWoodenBait:!1};c(i),h(""),setTimeout(()=>{u(i)},0)};function r(s){if(!s)return 0;const a=s.trim().toLowerCase().match(/^([\d,.]+)([kmb])?$/);if(!a)return Number(s.replace(/,/g,""))||0;let i=parseFloat(a[1].replace(/,/g,""));const n=a[2];return n==="k"?i*=1e3:n==="m"?i*=1e6:n==="b"&&(i*=1e9),Math.round(i)}const[m,h]=U.useState("");U.useEffect(()=>{(t.moneyPerHour===void 0||t.moneyPerHour===null||t.moneyPerHour===0)&&m===""&&(d("moneyPerHour",1/0),u(H(K({},t),{moneyPerHour:1/0})))},[t.shard]),U.useEffect(()=>{(t.moneyPerHour===null||t.moneyPerHour===void 0)&&m!==""&&h("")},[t.moneyPerHour]);const x=()=>{t.shard&&d("shard","")};return e.jsx("div",{className:"bg-slate-800/40 border border-slate-600/30 rounded-md p-3 space-y-3",children:e.jsxs("form",{onSubmit:s=>s.preventDefault(),className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-emerald-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),"Target Shard"]}),e.jsx(ze,{value:t.shard,onChange:s=>d("shard",s),onSelect:s=>{let a="common";if(s&&typeof s.rarity=="string"){const f=s.rarity.toLowerCase();f in le&&(a=f)}const i=le[a],n=H(K({},t),{shard:s.name,quantity:i});c(n),setTimeout(()=>u(n),0)},onFocus:x,placeholder:"Search for a shard..."})]}),e.jsx("div",{className:"flex gap-1.5",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:t.quantity===0?"":t.quantity,placeholder:"1",onChange:s=>d("quantity",Number(s.target.value)),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),s.currentTarget.blur())},className:"w-full px-3 py-1.5 text-sm bg-white/5 border border-white/10 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500/50 transition-colors duration-200"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-base font-semibold text-white flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-purple-400"}),"Settings"]}),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsxs("button",{type:"button",onClick:l,className:`
                  px-2 py-1.5 bg-amber-500/20 hover:bg-amber-500/30 
                  text-amber-400 font-medium rounded-md text-xs
                  border border-amber-500/20 hover:border-amber-500/30
                  transition-colors duration-200 flex items-center space-x-1 cursor-pointer
                `,children:[e.jsx(Ee,{className:"w-3 h-3"}),e.jsx("span",{children:"Max Stats"})]}),e.jsxs("button",{type:"button",onClick:o,className:`
                  px-2 py-1.5 bg-red-500/20 hover:bg-red-500/30 
                  text-red-400 font-medium rounded-md text-xs
                  border border-red-500/20 hover:border-red-500/30
                  transition-colors duration-200 flex items-center space-x-1 cursor-pointer
                `,children:[e.jsx(Me,{className:"w-3 h-3"}),e.jsx("span",{children:"Reset"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-fuchsia-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-fuchsia-500 rounded-full"}),"Hunter Fortune"]}),e.jsx("input",{type:"number",min:"0",value:t.hunterFortune===0?"":t.hunterFortune,placeholder:"0",onChange:s=>d("hunterFortune",Number(s.target.value)),className:`
                  w-full px-3 py-2 text-sm
                  bg-white/5 border border-white/10 rounded-md
                  text-white placeholder-slate-400
                  focus:outline-none focus:ring-2 focus:ring-fuchsia-500/50 focus:border-fuchsia-500/50
                  transition-colors duration-200
                `})]}),e.jsxs("div",{className:"space-y-0",children:[e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx("label",{htmlFor:"excludeChameleon",className:"text-sm font-medium text-slate-200 flex-1 cursor-pointer",children:"Exclude Chameleon"}),e.jsx("button",{type:"button",role:"switch","aria-checked":t.excludeChameleon,onClick:()=>d("excludeChameleon",!t.excludeChameleon),className:`relative inline-flex h-6 w-11 items-center rounded-full border border-white/10 transition-colors duration-200 cursor-pointer
                    ${t.excludeChameleon?"bg-fuchsia-600":"bg-white/5"}
                    hover:border-fuchsia-400`,style:{boxShadow:"none"},children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full shadow transition-transform duration-200 border border-white/10
                    ${t.excludeChameleon?"bg-fuchsia-400":"bg-slate-300/70"}
                    ${t.excludeChameleon?"translate-x-5":"translate-x-0.5"}`,style:{paddingLeft:"1px"}})})]}),e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx("label",{htmlFor:"excludeWoodenBait",className:"text-sm font-medium text-slate-200 flex-1 cursor-pointer",children:"Exclude Wooden Bait"}),e.jsx("button",{type:"button",role:"switch","aria-checked":t.noWoodenBait,onClick:()=>d("noWoodenBait",!t.noWoodenBait),className:`relative inline-flex h-6 w-11 items-center rounded-full border border-white/10 transition-colors duration-200 cursor-pointer
                    ${t.noWoodenBait?"bg-fuchsia-600":"bg-white/5"}
                    hover:border-fuchsia-400`,style:{boxShadow:"none"},children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full shadow transition-transform duration-200 border border-white/10
                    ${t.noWoodenBait?"bg-fuchsia-400":"bg-slate-300/70"}
                    ${t.noWoodenBait?"translate-x-5":"translate-x-0.5"}`,style:{paddingLeft:"1px"}})})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"flex items-center gap-2 text-sm font-medium text-blue-300",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Shard Levels"]}),e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:[{key:"newtLevel",label:"Newt"},{key:"salamanderLevel",label:"Salamander"},{key:"lizardKingLevel",label:"Lizard King"},{key:"leviathanLevel",label:"Leviathan"},{key:"pythonLevel",label:"Python"},{key:"kingCobraLevel",label:"King Cobra"},{key:"seaSerpentLevel",label:"Sea Serpent"},{key:"tiamatLevel",label:"Tiamat"},{key:"crocodileLevel",label:"Crocodile"}].map(({key:s,label:a})=>{const i=He[s];return e.jsx(Ne,{value:t[s]||0,onChange:n=>d(s,n),label:a,tooltipTitle:i.title,tooltipContent:we(i.description),tooltipShardIcon:i.shardIcon,tooltipRarity:i.rarity,tooltipWarning:i.warning},s)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"flex items-center gap-2 text-sm font-medium text-orange-300",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),"Kraken Shard"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{value:t.kuudraTier||"none",onChange:s=>d("kuudraTier",s),label:"Kuudra Tier"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",min:"0",value:m,onChange:s=>{if(h(s.target.value),s.target.value.trim()==="")d("moneyPerHour",1/0),u(H(K({},t),{moneyPerHour:1/0}));else{const a=r(s.target.value);d("moneyPerHour",a)}},onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),s.currentTarget.blur())},className:"w-full px-3 py-2 pr-20 text-sm bg-white/5 border border-white/10 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500/50 focus:border-orange-500/50 hover:border-white/20 hover:bg-white/10 transition-all duration-200"}),e.jsx("div",{className:"absolute right-3 top-2.5 text-xs text-slate-500 pointer-events-none",children:"coins / hr"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Empty to ignore key cost"})]})]})]})]})})},ee=({tree:u,data:t,isTopLevel:c=!1,totalShardsProduced:d=u.quantity,nodeId:l,expandedStates:o,onToggle:r})=>{var k,$,_;const m=t.shards[u.shard],h=v=>{const p=t.recipes[v];if(!(p!=null&&p.length))return null;const S={U8:R=>R.inputs.includes("C35")&&R.inputs.includes("U38"),C35:R=>R.inputs.includes("C23")&&R.inputs.includes("U38")}[v];return S?p.find(S):p.sort((R,C)=>C.outputQuantity-R.outputQuantity)[0]},x=v=>v?e.jsx(Qe,{className:"w-4 h-4 text-amber-400"}):e.jsx(Fe,{className:"w-4 h-4 text-amber-400"}),s=(v,p,y=!0)=>e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-white",children:[v,"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${p.id}.png`,alt:p.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:z(p.rarity),children:p.name}),y&&e.jsxs("div",{className:"text-right min-w-[80px] ml-2",children:[e.jsx("span",{className:"text-slate-300 text-xs font-medium",children:J(p.rate)}),e.jsx("span",{className:"text-slate-500 text-xs mx-0.5",children:"/"}),e.jsx("span",{className:"text-slate-400 text-xs",children:"hr"})]})]}),a=(v,p,y,S,R,C,T=!1,P)=>e.jsxs("div",{className:"flex flex-wrap items-center gap-x-2 text-sm font-medium",children:[T&&e.jsxs("span",{className:"font-normal text-xs text-amber-300",children:["Step ",P," :"]}),s(v,p,!1),e.jsx("span",{children:" = "}),e.jsxs("span",{className:"text-slate-400",children:[y,"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${S.id}.png`,alt:S.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:z(S.rarity),children:S.name}),e.jsx("span",{children:" + "}),e.jsxs("span",{className:"text-slate-400",children:[R,"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${C.id}.png`,alt:C.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:z(C.rarity),children:C.name})]}),i=(v,p)=>e.jsxs("div",{className:"bg-slate-600/20 rounded border border-slate-300/50 flex items-center justify-between px-3 py-1.5 text-sm font-medium gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),s(v,p,!1),e.jsx("span",{className:"px-1 py-0.4 text-xs bg-green-500/20 text-green-400 border border-green-500/30 rounded-md flex-shrink-0",children:"Direct"})]}),e.jsxs("div",{className:"text-right min-w-[80px] ml-2",children:[e.jsx("span",{className:"text-slate-300 text-xs font-medium",children:J(p.rate)}),e.jsx("span",{className:"text-slate-500 text-xs mx-0.5",children:"/"}),e.jsx("span",{className:"text-slate-400 text-xs",children:"hr"})]})]}),n=(v,p,y,S=1)=>{var q;const R=v.outputQuantity,C=t.shards[v.inputs[0]],T=t.shards[v.inputs[1]],P=C.fuse_amount,Q=T.fuse_amount,I=`${y}-${p.id}`,D=(q=o.get(I))!=null?q:!0;return e.jsxs("div",{className:"bg-slate-600/20 rounded border border-slate-300/50 overflow-hidden",children:[e.jsxs("button",{onClick:()=>r(I),className:"w-full px-3 py-1.5 text-left cursor-pointer hover:bg-slate-800/40 transition-colors flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[x(D),a(R,p,P,C,Q,T)]}),e.jsx("div",{className:"text-right min-w-[80px] ml-2",children:e.jsxs("div",{className:"flex items-center justify-end space-x-1.5",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"fusions"}),e.jsx("span",{className:"font-medium text-white text-xs",children:"1"})]})})]}),D&&e.jsx("div",{className:"border-t border-slate-400/70 pl-3 pr-0.5 py-0.5 flex flex-col gap-0.5",children:v.inputs.map(M=>{const F=t.shards[M];if(!F)return null;const B=h(M);return M==="C11"||M==="U38"||M==="C23"?e.jsx("div",{children:i(F.fuse_amount,F)},`direct-${M}`):B&&S<2?e.jsx("div",{children:n(B,F,I,S+1)},`sub-${M}`):null})})]})};if(u.method==="cycle"){const v=(k=o.get(l))!=null?k:!0,p=u.cycles.reduce((y,S)=>y+S.expectedCrafts,0);return e.jsxs("div",{className:"flex flex-col border border-slate-400/70 rounded-md bg-slate-500/40",children:[e.jsxs("button",{className:"flex items-center justify-between w-full px-3 py-1.5 text-left cursor-pointer hover:bg-slate-800/40 transition-colors",onClick:()=>r(l),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[x(v),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-xs text-amber-300",children:[p," crafts"]}),e.jsx($e,{className:"w-4 text-amber-400"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s(Math.floor(u.quantity),m,!1),e.jsx("span",{className:"px-1 bg-amber-500/20 text-amber-400 border border-amber-400/40 text-[11px] font-medium rounded-md",children:"CYCLE !"})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-1.5",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"fusions"}),e.jsx("span",{className:"font-medium text-white text-xs",children:p})]})})]}),v&&u.cycles.length>0&&e.jsx("div",{className:"border-t border-slate-400/70 pl-3 pr-0.5 py-0.5 space-y-2",children:u.cycles.map((y,S)=>e.jsxs("div",{children:[e.jsx("div",{className:"space-y-0.5",children:[...y.steps].slice().reverse().map((R,C)=>{var B;const T=R.recipe,P=t.shards[R.outputShard],Q=t.shards[T.inputs[0]],I=t.shards[T.inputs[1]],D=Q.fuse_amount,q=I.fuse_amount;let M=T.outputQuantity;T.isReptile&&(M*=y.multiplier);const F=y.steps.length-C;if(F===1){const Y=`${l}-step-${F}`,se=(B=o.get(Y))!=null?B:!0;return e.jsxs("div",{className:"bg-slate-600/20 rounded border border-slate-300/50 overflow-hidden",children:[e.jsxs("button",{onClick:()=>r(Y),className:"w-full px-3 py-1.5 text-left cursor-pointer hover:bg-slate-800/40 transition-colors flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[x(se),a(M,P,D,Q,q,I,!0,F)]}),e.jsx("div",{className:"text-right min-w-[80px] ml-2",children:e.jsxs("div",{className:"flex items-center justify-end space-x-1.5",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"fusions"}),e.jsx("span",{className:"font-medium text-white text-xs",children:y.expectedCrafts})]})})]}),se&&e.jsx("div",{className:"border-t border-slate-400/70 pl-3 pr-0.5 py-0.5 space-y-1",children:T.inputs.map(A=>{const ae=t.shards[A],ne=h(A);return ne&&ae&&A!=="C11"&&A!=="U38"&&A!=="C23"?e.jsx("div",{className:"space-y-1",children:n(ne,ae,l)},A):null})})]},C)}else return e.jsxs("div",{className:"px-3 py-1.5 bg-slate-600/20 rounded border border-slate-300/50 flex items-center justify-between",children:[a(M,P,D,Q,q,I,!0,F),e.jsx("div",{className:"text-right min-w-[80px] ml-2",children:e.jsxs("div",{className:"flex items-center justify-end space-x-1.5",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"fusions"}),e.jsx("span",{className:"font-medium text-white text-xs",children:y.expectedCrafts})]})})]},C)})}),(()=>{const R=new Set(y.steps.map(T=>T.outputShard)),C={};return y.steps.forEach(T=>{T.recipe.inputs.forEach(P=>{const Q=t.shards[P];!Q||R.has(P)||(C[P]||(C[P]={quantity:0,shard:Q}),C[P].quantity+=Q.fuse_amount)})}),e.jsx("div",{className:"flex flex-col gap-0.5 mt-0.5",children:Object.values(C).map(({quantity:T,shard:P})=>e.jsx("div",{children:i(T*p,P)},P.id))})})()]},S))})]})}if(u.method==="direct")return e.jsxs("div",{className:"flex items-center justify-between px-3 py-1 bg-slate-800 rounded-md border border-slate-600",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-0.5",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),s(u.quantity,m,!1),e.jsx("span",{className:"px-1 py-0.4 text-xs bg-green-500/20 text-green-400 border border-green-500/30 rounded-md flex-shrink-0",children:"Direct"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-xs text-slate-300",children:[J(m.rate),e.jsx("span",{className:"text-slate-500 text-xs mx-0.5",children:"/"}),e.jsx("span",{className:"text-slate-400 text-xs",children:"hr"})]})})]});const f=($=o.get(l))!=null?$:!0,b=u.inputs[0],g=u.inputs[1],j=t.shards[b.shard],w=t.shards[g.shard],L="craftsNeeded"in u&&(_=u.craftsNeeded)!=null?_:1,E=c?d:u.quantity;return e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-md overflow-hidden",children:[e.jsx("button",{onClick:()=>r(l),className:"w-full px-3 py-1 text-left cursor-pointer hover:bg-slate-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-1.5 p-0.5",children:[x(f),e.jsxs("div",{className:"text-white flex items-center",children:[e.jsxs("span",{className:"font-medium text-sm",children:[Math.floor(E),"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${m.id}.png`,alt:m.name,className:"w-5 h-5 object-contain inline-block align-middle mx-2 flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`font-medium ${z(m.rarity)} text-sm whitespace-nowrap truncate`,style:{maxWidth:"8rem"},title:Ce(m,!1),children:m.name}),e.jsxs("span",{className:"text-slate-400 text-sm font-medium flex items-center",children:[e.jsx("span",{className:"mx-2 text-white",children:"="}),e.jsxs("span",{children:[Math.floor(b.quantity),"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${j.id}.png`,alt:j.name,className:"w-5 h-5 object-contain inline-block align-middle mx-2 flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:z(j.rarity)+" whitespace-nowrap truncate",style:{maxWidth:"8rem"},children:j.name}),e.jsx("span",{className:"mx-2 text-white",children:"+"}),e.jsxs("span",{children:[Math.floor(g.quantity),"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${w.id}.png`,alt:w.name,className:"w-5 h-5 object-contain inline-block align-middle mx-2 flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:z(w.rarity)+" whitespace-nowrap truncate",style:{maxWidth:"8rem"},children:w.name})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-1.5",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"fusions"}),e.jsx("span",{className:"font-medium text-white text-xs",children:L})]})})]})}),f&&e.jsxs("div",{className:"border-t border-slate-600 pl-3 pr-0.5 py-0.5 space-y-0.5",children:[e.jsx(ee,{tree:b,data:t,nodeId:`${l}-0`,expandedStates:o,onToggle:r}),e.jsx(ee,{tree:g,data:t,nodeId:`${l}-1`,expandedStates:o,onToggle:r})]})]})},Ae=({result:u,data:t,targetShardName:c})=>{const[d,l]=N.useState(new Map),[o,r]=N.useState(""),m=(a,i="root")=>{const n=new Map,f=(b,g)=>{b.method==="recipe"&&b.inputs&&(n.set(g,!0),b.inputs.forEach((j,w)=>{f(j,`${g}-${w}`)}))};return f(a,i),n};U.useEffect(()=>{if(u.tree){const a=JSON.stringify(u.tree);if(a!==o){const i=m(u.tree);l(i),r(a)}}},[u.tree,o]);const h=()=>{const a=new Map(d);for(const i of a.keys())a.set(i,!0);l(a)},x=()=>{const a=new Map(d);for(const i of a.keys())a.set(i,!1);l(a)},s=a=>{const i=new Map(d);i.set(a,!i.get(a)),l(i)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-md p-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-md flex items-center justify-center",children:e.jsx(Oe,{className:"w-4 h-4 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Time per Shard"}),e.jsx("p",{className:"text-white font-medium text-sm",children:V(u.timePerShard)})]})]})}),e.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-md p-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-md flex items-center justify-center",children:e.jsx(_e,{className:"w-4 h-4 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Total Time"}),e.jsx("p",{className:"text-white font-medium text-sm",children:V(u.totalTime)})]})]})}),e.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-md p-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-md flex items-center justify-center",children:e.jsx(de,{className:"w-4 h-4 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Shards Produced"}),e.jsx("p",{className:"text-white font-medium text-sm",children:Math.floor(u.totalShardsProduced)})]})]})}),e.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-md p-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-md flex items-center justify-center",children:e.jsx(ue,{className:"w-4 h-4 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Total Fusions"}),e.jsxs("p",{className:"text-white font-medium text-sm",children:[u.totalFusions,"x",u.craftTime>1/12&&e.jsx("span",{className:"text-slate-400 mx-1",children:"•"}),u.craftTime>1/12&&e.jsx("span",{className:"text-slate-400",children:V(u.craftTime)})]})]})]})})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-slate-700 rounded-md",children:e.jsx(ue,{className:"w-5 h-5 text-blue-400"})}),"Materials Needed"]}),e.jsxs("div",{className:"px-3 py-1.5 bg-sky-500/20 border border-sky-500/30 text-sky-400 text-sm font-medium rounded-md",children:["for ",Math.floor(u.totalShardsProduced)," ",c," ",e.jsxs("span",{className:"text-slate-400",children:[Math.floor(u.craftsNeeded)," craft",Math.floor(u.craftsNeeded)>1?"s":""]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2",children:Array.from(u.totalQuantities).map(([a,i])=>{const n=t.shards[a],f=i,b=f/n.rate;return e.jsxs("div",{className:"bg-slate-700 border border-slate-600 rounded-md px-3 pt-1 pb-2 flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col items-start min-w-0 justify-center h-full",children:[e.jsxs("span",{className:"text-slate-300 font-medium text-base flex-shrink-0",children:[f,"x"]}),e.jsxs("span",{className:`mt-0 font-medium text-sm ${z(n.rarity)} flex items-center flex-shrink-0`,children:[e.jsx("img",{src:`/SkyShards/shardIcons/${n.id}.png`,alt:n.name,className:"w-5 h-5 object-contain flex-shrink-0 inline-block align-middle mr-2",loading:"lazy"}),n.name]})]}),e.jsxs("div",{className:"flex flex-col items-end ml-2 justify-center h-full",children:[e.jsxs("div",{className:"text-sm text-slate-400 whitespace-nowrap",children:[J(n.rate)," ",e.jsx("span",{className:"text-slate-500",children:" / "})," ",e.jsx("span",{className:"text-slate-500",children:"hr"})]}),e.jsx("div",{className:"text-xs text-slate-400 whitespace-nowrap mt-1",children:V(b)})]})]},a)})})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-slate-700 rounded-md",children:e.jsx(de,{className:"w-5 h-5 text-purple-400"})}),"Fusion Tree"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:h,className:"px-3 py-1.5 bg-green-500/10 border border-green-500/20 hover:border-green-400/30 text-white text-xs font-medium rounded-md hover:bg-green-500/20 transition-all duration-200 cursor-pointer",children:"Expand All"}),e.jsx("button",{onClick:x,className:"px-3 py-1.5 bg-orange-500/10 border border-orange-500/20 hover:border-orange-400/30 text-white text-xs font-medium rounded-md hover:bg-orange-500/20 transition-all duration-200 cursor-pointer",children:"Collapse All"})]})]}),e.jsx("div",{className:"w-full overflow-x-auto scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-slate-900",children:e.jsx("div",{className:"min-w-[650px]",children:e.jsx(ee,{tree:u.tree,data:t,isTopLevel:!0,totalShardsProduced:u.totalShardsProduced,nodeId:"root",expandedStates:d,onToggle:s})})})]})]})},W=class W{static getInstance(){return W.instance||(W.instance=new W),W.instance}parseData(t){return O(this,null,function*(){var c,d;try{const[l,o]=yield Promise.all([fetch("/SkyShards/fusion-data.json"),fetch("/SkyShards/rates.json")]),r=yield l.json(),m=yield o.json(),h={};for(const s in r.recipes){h[s]=[];for(const a in r.recipes[s]){const i=parseInt(a);r.recipes[s][a].forEach(f=>{const b=f.some(g=>r.shards[g].family.includes("Reptile"));h[s].push({inputs:f,outputQuantity:i,isReptile:b})})}}const x={};for(const s in r.shards){let a=(d=(c=t.customRates[s])!=null?c:m[s])!=null?d:0;if(s==="L15"&&a===0){const i=t.moneyPerHour==null?1/0:t.moneyPerHour;a=this.calculateKuudraRate(t.kuudraTier,i)}a>0&&(t.noWoodenBait&&ke.includes(s)&&(a*=.05),Le.includes(s)||(a=this.applyFortuneModifiers(a,s,r.shards[s],t))),t.excludeChameleon&&s==="L4"&&(a=0),x[s]=H(K({},r.shards[s]),{id:s,rate:a})}return{recipes:h,shards:x}}catch(l){throw new Error(`Failed to parse data: ${l}`)}})}calculateKuudraRate(t,c){const l={t1:{baseTime:135,cost:155e3,multiplier:1},t2:{baseTime:135,cost:31e4,multiplier:1},t3:{baseTime:135,cost:582e3,multiplier:2},t4:{baseTime:135,cost:1164e3,multiplier:2},t5:{baseTime:165,cost:2328e3,multiplier:3}}[t];if(!l)return 0;let o;return c===1/0?o=0:c===0?o=1e12:o=l.cost/c*3600,l.multiplier*(3600/(l.baseTime+o))}applyFortuneModifiers(t,c,d,l){let o=l.hunterFortune;const r=1+5*l.tiamatLevel/100,m=1+2*l.seaSerpentLevel/100*r,h=2*l.pythonLevel/100*m,x=l.kingCobraLevel/100*m;switch(d.rarity){case"common":o+=2*l.newtLevel;break;case"uncommon":o+=2*l.salamanderLevel;break;case"rare":o+=l.lizardKingLevel;break;case"epic":o+=l.leviathanLevel;break}return l.frogPet&&(t*=1.1),c in ce&&(ce[c]&&(t*=1+h),o*=1+x),t*(1+o/100)}computeMinCosts(t,c,d,l){const o=new Map,r=new Map,m=Object.keys(t.shards),h=1+5*l/100,x=1+2*d/100*h,s=1+2*c/100*x,a=.8/3600;m.forEach(n=>{const f=t.shards[n].rate>0?1/t.shards[n].rate:1/0;o.set(n,f),r.set(n,{recipe:null})});let i=!0;for(;i;)i=!1,m.forEach(n=>{(t.recipes[n]||[]).forEach(b=>{const[g,j]=b.inputs,w=t.shards[g].fuse_amount,L=t.shards[j].fuse_amount,E=o.get(g)*w,k=o.get(j)*L,$=E+k+a,_=b.isReptile?b.outputQuantity*s:b.outputQuantity,v=$/_;v<o.get(n)&&(o.set(n,v),r.set(n,{recipe:b}),i=!0)})});return{minCosts:o,choices:r}}findCycleNodes(t){const c=new Map;for(const[s,a]of t)a.recipe&&c.set(s,a.recipe.inputs);let d=0;const l=new Map,o=new Map,r=new Map,m=[],h=[],x=s=>{var i;l.set(s,d),o.set(s,d),d++,m.push(s),r.set(s,!0);const a=c.get(s)||[];for(const n of a)c.has(n)&&(l.has(n)?r.get(n)&&o.set(s,Math.min(o.get(s),l.get(n))):(x(n),o.set(s,Math.min(o.get(s),o.get(n)))));if(o.get(s)===l.get(s)){const n=[];let f;do f=m.pop(),r.set(f,!1),n.push(f);while(f!==s);(n.length>1||n.length===1&&((i=c.get(s))!=null&&i.includes(s)))&&h.push(n)}};for(const s of c.keys())l.has(s)||x(s);return h}buildCycle(t,c,d){const l=[];for(const o of d)if(o.includes(t)){const r=[];for(const m of o){const h=c.get(m);h!=null&&h.recipe&&r.push({outputShard:m,recipe:h.recipe})}l.push(r)}return l}buildRecipeTree(t,c,d,l){if(l.flat().includes(c)){const r=this.buildCycle(c,d,l),{minCosts:m,choices:h}=this.computeMinCosts(t,0,0,0),x=l.flat().reduce((i,n)=>m.get(n)<m.get(i)?n:i,l.flat()[0]),s=this.buildRecipeTree(t,x,h,[]),a={total:0};return this.assignQuantities(s,t.shards[x].fuse_amount,t,a,h,1),{shard:c,method:"cycle",quantity:0,cycles:r.map(i=>({steps:i,expectedCrafts:0,expectedOutput:0,baseOutput:0,multiplier:1})),craftsNeeded:0,inputRecipe:s}}const o=d.get(c);if(o.recipe===null)return{shard:c,method:"direct",quantity:0};{const r=o.recipe,[m,h]=r.inputs,x=this.buildRecipeTree(t,m,d,l),s=this.buildRecipeTree(t,h,d,l);return l.flat().includes(c)?{shard:c,method:"cycleNode",recipe:r,inputs:[x,s],quantity:0,craftsNeeded:0}:{shard:c,method:"recipe",recipe:r,inputs:[x,s],quantity:0,craftsNeeded:0}}}assignQuantities(t,c,d,l,o,r){switch(t.quantity=c,t.method){case"recipe":{const m=t.recipe,h=m.isReptile?m.outputQuantity*r:m.outputQuantity,x=Math.ceil(c/h);t.craftsNeeded=x,l.total+=x;const[s,a]=m.inputs,i=d.shards[s].fuse_amount,n=d.shards[a].fuse_amount,f=x*i,b=x*n;this.assignQuantities(t.inputs[0],f,d,l,o,r),this.assignQuantities(t.inputs[1],b,d,l,o,r);break}case"cycleNode":{const m=t.recipe,h=m.isReptile?m.outputQuantity*r:m.outputQuantity,x=Math.ceil(c/h);t.craftsNeeded=x,l.total+=x;const[s,a]=m.inputs,i=d.shards[s].fuse_amount,n=d.shards[a].fuse_amount;this.assignQuantities(t.inputs[0],i,d,l,o,r),this.assignQuantities(t.inputs[1],n,d,l,o,r);break}case"cycle":for(const m of t.cycles){const h=m.steps.find(b=>b.outputShard===t.shard);if(!h)continue;const x=h.recipe,s=x.outputQuantity,a=x.isReptile?s*r:s;let i=0;m.steps.forEach(b=>{b.recipe.inputs.forEach(g=>{if(g===t.shard){const j=d.shards[g];i+=j.fuse_amount}})});const n=a-i,f=n>0?Math.ceil(c/n):Math.ceil(c/a);m.expectedCrafts=f,m.expectedOutput=a,m.baseOutput=s,m.multiplier=r,l.total+=f*m.steps.length}if(t.craftsNeeded=t.cycles.reduce((m,h)=>m+(h.expectedCrafts||0),0),t.cycles.length>0){const m=t.cycles[0].expectedCrafts,h=new Map;t.cycles[0].steps.forEach(s=>{s.recipe.inputs.forEach(a=>{const i=d.shards[a],n=h.get(a)||0;h.set(a,n+i.fuse_amount)})});const x=new Set(t.cycles[0].steps.map(s=>s.outputShard));h.forEach((s,a)=>{if(!x.has(a)){const i=s*m,n=o.get(a);if(n&&n.recipe){const f=this.buildRecipeTree(d,a,o,[]);this.assignQuantities(f,i,d,l,o,r)}}})}break}}collectTotalQuantities(t,c){const d=new Map,l=o=>{switch(o.method){case"direct":d.set(o.shard,(d.get(o.shard)||0)+o.quantity);break;case"recipe":case"cycleNode":o.inputs.forEach(l);break;case"cycle":if(o.cycles.length>0){for(const r of o.cycles){const h=o.cycles[0].expectedCrafts,x=new Map;r.steps.forEach(s=>{const[a,i]=s.recipe.inputs,n=c.shards[a].fuse_amount,f=c.shards[i].fuse_amount;c.shards[a].family.includes("Reptile")||x.set(a,(x.get(a)||0)+h*n),c.shards[i].family.includes("Reptile")||x.set(i,(x.get(i)||0)+h*f)}),x.forEach((s,a)=>{d.set(a,(d.get(a)||0)+s)})}l(o.inputRecipe)}break}};return l(t),d}calculateOptimalPath(t,c,d){return O(this,null,function*(){var E;const l=yield this.parseData(d);if(!l.shards[t])return{timePerShard:0,totalTime:0,totalShardsProduced:0,craftsNeeded:0,totalQuantities:new Map,totalFusions:0,craftTime:0,tree:{shard:t,method:"direct",quantity:0}};const{minCosts:o,choices:r}=this.computeMinCosts(l,d.crocodileLevel,d.seaSerpentLevel,d.tiamatLevel),m=d.crocodileLevel>0?this.findCycleNodes(r):[],h=this.buildRecipeTree(l,t,r,m),x={total:0},s=1+5*d.tiamatLevel/100,a=1+2*d.seaSerpentLevel/100*s,i=1+2*d.crocodileLevel/100*a;this.assignQuantities(h,c,l,x,r,i);const n=this.collectTotalQuantities(h,l);let f=c,b=1;const g=r.get(t);if(g!=null&&g.recipe){const k=g.recipe.isReptile?g.recipe.outputQuantity*i:g.recipe.outputQuantity;b=Math.ceil(c/k),f=b*k}const j=(E=o.get(t))!=null?E:0,w=j*f,L=x.total*.8/3600;return{timePerShard:j,totalTime:w,totalShardsProduced:f,craftsNeeded:b,totalQuantities:n,totalFusions:x.total,craftTime:L,tree:h}})}};ie(W,"instance");let Z=W;const he=Object.freeze(Object.defineProperty({__proto__:null,CalculationService:Z},Symbol.toStringTag,{value:"Module"})),De=()=>{const[u,t]=N.useState(null),[c,d]=N.useState(!1),[l,o]=N.useState(null),r=N.useCallback((h,x,s)=>O(null,null,function*(){try{d(!0),o(null);const i=yield Z.getInstance().calculateOptimalPath(h,x,s);t(i)}catch(a){o(a instanceof Error?a.message:"Calculation failed"),t(null)}finally{d(!1)}}),[]),m=N.useCallback(()=>{t(null),o(null)},[]);return{result:u,loading:c,error:l,calculate:r,clearResult:m}},qe=({onSubmit:u})=>{const{setForm:t}=te();return e.jsx(We,{onSubmit:c=>u(c,t)})},Be=()=>{const{result:u,setResult:t,calculationData:c,setCalculationData:d,targetShardName:l,setTargetShardName:o,form:r}=te(),{loading:m,error:h}=De(),{customRates:x}=Re(),[s,a]=N.useState(!1),i=(n,f)=>O(null,null,function*(){f(n);try{if(!n.shard||n.shard.trim()===""){console.warn("Calculation skipped: No shard selected");return}a(!1);const j=(yield X.getInstance().getShardNameToKeyMap())[n.shard.toLowerCase()];if(!j){console.warn(`Calculation skipped: Shard "${n.shard}" not found in data`);return}o(n.shard);const L={customRates:Object.fromEntries(Object.entries(x).filter(([,v])=>v!==void 0)),hunterFortune:n.hunterFortune,excludeChameleon:n.excludeChameleon,frogPet:n.frogPet,newtLevel:n.newtLevel,salamanderLevel:n.salamanderLevel,lizardKingLevel:n.lizardKingLevel,leviathanLevel:n.leviathanLevel,pythonLevel:n.pythonLevel,kingCobraLevel:n.kingCobraLevel,seaSerpentLevel:n.seaSerpentLevel,tiamatLevel:n.tiamatLevel,crocodileLevel:n.crocodileLevel,kuudraTier:n.kuudraTier,moneyPerHour:n.moneyPerHour,noWoodenBait:n.noWoodenBait},k=(yield oe(()=>Promise.resolve().then(()=>he),void 0)).CalculationService.getInstance(),$=yield k.calculateOptimalPath(j,n.quantity,L);t($);const _=yield k.parseData(L);d(_)}catch(b){b instanceof Error&&!b.message.includes("not found")&&console.error("Calculation failed:",b)}});return N.useEffect(()=>{r&&r.shard&&r.shard.trim()!==""&&O(null,null,function*(){try{const b=(yield X.getInstance().getShardNameToKeyMap())[r.shard.toLowerCase()];if(!b)return;o(r.shard);const j={customRates:Object.fromEntries(Object.entries(x).filter(([,$])=>$!==void 0)),hunterFortune:r.hunterFortune,excludeChameleon:r.excludeChameleon,frogPet:r.frogPet,newtLevel:r.newtLevel,salamanderLevel:r.salamanderLevel,lizardKingLevel:r.lizardKingLevel,leviathanLevel:r.leviathanLevel,pythonLevel:r.pythonLevel,kingCobraLevel:r.kingCobraLevel,seaSerpentLevel:r.seaSerpentLevel,tiamatLevel:r.tiamatLevel,crocodileLevel:r.crocodileLevel,kuudraTier:r.kuudraTier,moneyPerHour:r.moneyPerHour,noWoodenBait:r.noWoodenBait},L=(yield oe(()=>Promise.resolve().then(()=>he),void 0)).CalculationService.getInstance(),E=yield L.calculateOptimalPath(b,r.quantity,j);t(E);const k=yield L.parseData(j);d(k)}catch(n){n instanceof Error&&!n.message.includes("not found")&&console.error("Calculation failed (customRates effect):",n)}})},[x,r,t,d,o]),e.jsx("div",{className:"min-h-screen space-y-3 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-7 gap-1 lg:gap-4",children:[e.jsxs("div",{className:"xl:col-span-2",children:[e.jsx("div",{className:"xl:hidden mb-3",children:e.jsxs("button",{onClick:()=>a(!s),className:`
                w-full px-3 py-2.5 
                bg-purple-500/10 border border-purple-500/20 hover:border-purple-400/30
                rounded-md text-white hover:bg-purple-500/20 
                flex items-center justify-center space-x-2 
                transition-colors duration-200 font-medium text-sm cursor-pointer
              `,children:[s?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(me,{className:"w-4 h-4"}),e.jsxs("span",{children:[s?"Hide":"Show"," Configuration"]})]})}),e.jsx("div",{className:`${s?"block":"hidden xl:block"}`,children:e.jsx(qe,{onSubmit:i})})]}),e.jsxs("div",{className:"xl:col-span-5 space-y-3",children:[h&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-md p-3 flex items-start space-x-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-400",children:"Calculation Error"}),e.jsx("p",{className:"text-red-300 text-sm mt-1",children:h})]})]}),u&&c&&e.jsx(Ae,{result:u,data:c,targetShardName:l}),!u&&!m&&!h&&e.jsx("div",{className:"text-center py-10 bg-white/5 border border-white/10 rounded-md",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-500/20 border border-purple-500/20 rounded-md flex items-center justify-center mx-auto",children:e.jsx(me,{className:"w-6 h-6 text-purple-400"})}),e.jsx("h3",{className:"text-lg font-medium text-white",children:"Ready to Calculate"}),e.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Configure your settings and select a shard to see optimal fusion paths"})]})})]})]})})},Ge=()=>e.jsx(Be,{});export{Ge as CalculatorPage};
