var ce=Object.defineProperty,ie=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var H=(a,n,t)=>n in a?ce(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,O=(a,n)=>{for(var t in n||(n={}))ue.call(n,t)&&H(a,t,n[t]);if(B)for(var t of B(n))me.call(n,t)&&H(a,t,n[t]);return a},$=(a,n)=>ie(a,de(n));var Y=(a,n,t)=>new Promise((i,s)=>{var o=d=>{try{l(t.next(d))}catch(m){s(m)}},r=d=>{try{l(t.throw(d))}catch(m){s(m)}},l=d=>d.done?i(d.value):Promise.resolve(d.value).then(o,r);l((t=t.apply(a,n)).next())});import{j as e,b as R,i as he}from"./index-BGQAUm1O.js";import{r as h}from"./vendor-Dt516RNf.js";import{S as z}from"./ShardAutocomplete-BZUT_qLq.js";import{P as J,b as K,E as U}from"./icons-DNYyJ9Q2.js";import"./forms-CPIcrlzh.js";import"./dataService-BdYs6t7D.js";const X=({count:a,label:n,variant:t})=>{const i={green:"from-green-500/15 to-emerald-500/15 border-green-500/20 text-green-400",fuchsia:"from-fuchsia-500/15 to-pink-500/15 border-fuchsia-500/20 text-fuchsia-400"},s={green:"text-emerald-400",fuchsia:"text-pink-400"};return e.jsx("div",{className:`px-4 py-2 bg-gradient-to-r ${i[t]} rounded-md border`,children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:`font-medium ${i[t].split(" ")[3]}`,children:n}),e.jsx("span",{className:"text-slate-500",children:"•"}),e.jsx("span",{className:`font-semibold ${s[t]}`,children:a})]})})},Z=({value:a,onChange:n,placeholder:t,variant:i})=>{const s={green:"focus:ring-green-500/50 focus:border-green-500/50",fuchsia:"focus:ring-fuchsia-500/50 focus:border-fuchsia-500/50"};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a,onChange:o=>n(o.target.value),placeholder:t,className:`w-64 pl-8 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 ${s[i]} hover:bg-slate-700/70 transition-colors`}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})},N=({shardId:a,quantity:n,fusionData:t,size:i="md"})=>{var l;const s=t.shards[a],o=(l=n!=null?n:s==null?void 0:s.fuse_amount)!=null?l:2,r=i==="sm"?"w-6 h-6":"w-8 h-8";return s?e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium flex-shrink-0",children:[o,"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${a}.png`,alt:s.name,className:`${r} object-contain flex-shrink-0`,loading:"lazy"}),e.jsx("span",{className:`text-sm font-medium truncate ${R(s.rarity)}`,title:s.name,children:s.name})]}):null},xe=()=>{const[a,n]=h.useState(null),[t,i]=h.useState(!1);return h.useEffect(()=>{Y(null,null,function*(){try{i(!0);const r=yield(yield fetch("/SkyShards/fusion-data.json")).json();n(r)}catch(o){console.error("Failed to load data:",o)}finally{i(!1)}})},[]),{fusionData:a,loading:t}},G=()=>{const[a,n]=h.useState({}),t=h.useRef({});return h.useEffect(()=>{const r=l=>{const d=l.target;let m=!1;Object.entries(a).forEach(([p,v])=>{var g;v&&t.current[p]&&!((g=t.current[p])!=null&&g.contains(d))&&(m=!0)}),m&&n({})};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[a]),{dropdownOpen:a,toggleDropdown:r=>{n(l=>$(O({},l),{[r]:!l[r]}))},closeDropdown:r=>{n(l=>$(O({},l),{[r]:!1}))},setRef:(r,l)=>{t.current[r]=l}}},ee=["common","uncommon","rare","epic","legendary"],pe=(a,n)=>{const t=new Map;Object.entries(n.recipes).forEach(([s,o])=>{Object.entries(o).forEach(([r,l])=>{const d=parseInt(r,10);l.forEach(m=>{if(m.length===2){const[p,v]=m;let g=null;if(p===a.key?g=v:v===a.key&&(g=p),g){t.has(s)||t.set(s,{partners:new Set,quantities:new Map});const I=t.get(s);I.partners.add(g),I.quantities.set(g,d)}}})})});const i=[];return t.forEach((s,o)=>{var l;const r=((l=n.shards[o])==null?void 0:l.fuse_amount)||2;i.push({output:o,fuseAmount:r,partners:Array.from(s.partners).sort(),quantities:s.quantities})}),i.sort((s,o)=>{const r=n.shards[s.output],l=n.shards[o.output],d=ee.indexOf(((r==null?void 0:r.rarity)||"common").toLowerCase()),m=ee.indexOf(((l==null?void 0:l.rarity)||"common").toLowerCase());return d!==m?d-m:((r==null?void 0:r.name)||"").localeCompare((l==null?void 0:l.name)||"")}),i},fe=(a,n)=>{const t=[];return Object.entries(n.recipes).forEach(([i,s])=>{i===a.key&&Object.entries(s).forEach(([o,r])=>{const l=parseInt(o,10);r.forEach(d=>{if(d.length===2){const[m,p]=d;t.push({input1:m,input2:p,quantity:l})}})})}),t},ge=(a,n,t)=>n.trim()?a.filter(i=>{const s=t.shards[i.output];return(s==null?void 0:s.name.toLowerCase().includes(n.toLowerCase()))||i.partners.some(o=>{var r;return(r=t.shards[o])==null?void 0:r.name.toLowerCase().includes(n.toLowerCase())})}):a,je=a=>{const n=new Map;return a.forEach(t=>{n.has(t.input1)||n.set(t.input1,[]),n.get(t.input1).push({input2:t.input2,quantity:t.quantity})}),n},be=(a,n,t)=>Array.from(a.entries()).filter(([i,s])=>{if(!n.trim())return!0;const o=t.shards[i];return(o==null?void 0:o.name.toLowerCase().includes(n.toLowerCase()))||s.some(r=>{var l;return(l=t.shards[r.input2])==null?void 0:l.name.toLowerCase().includes(n.toLowerCase())})}),Oe=()=>{const{selectedShard:a,setSelectedShard:n,selectedOutputShard:t,setSelectedOutputShard:i}=he(),{fusionData:s,loading:o}=xe(),[r,l]=h.useState(""),[d,m]=h.useState(""),[p,v]=h.useState([]),[g,I]=h.useState({}),[P,F]=h.useState(""),[q,se]=h.useState(""),[E,M]=h.useState([]),[te,ae]=h.useState({}),L=G(),D=G();h.useEffect(()=>{if(!a||!s){v([]);return}v(pe(a,s))},[a,s]),h.useEffect(()=>{if(!t||!s){M([]);return}M(fe(t,s))},[t,s]);const W=c=>{n(c),i(null),F("")},A=()=>{r&&l("")},ne=c=>{i(c),n(null),l(""),m("")},re=()=>{P&&F("")};if(o&&!s)return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"w-full border-b border-slate-700/30",children:e.jsx("div",{className:"px-4 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-full max-w-lg",children:e.jsx(z,{value:r,onChange:l,onSelect:W,onFocus:A,placeholder:"Search for a shard to see all fusion recipes...",className:"w-full text-sm py-2 px-3"})})})})}),e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"w-8 h-8 border-2 border-purple-500/20 border-t-purple-500 rounded-full animate-spin"})})]});if(!s)return null;const _=ge(p,d,s),le=je(E),V=be(le,q,s);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("div",{className:"px-4 py-4",children:[e.jsxs("div",{className:"flex justify-center gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-800/40 border border-slate-600/30 rounded-md p-4 flex flex-col gap-2 space-y-3 w-full max-w-lg",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-green-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Input Shard"]}),e.jsx(z,{value:r,onChange:l,onSelect:W,onFocus:A,placeholder:"Search for a shard to see all fusion recipes...",className:"w-full"})]}),a&&e.jsx("div",{className:"flex items-center justify-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-lg",children:[e.jsx("span",{className:"text-slate-300",children:"What can you make with"}),e.jsx("img",{src:`/SkyShards/shardIcons/${a.key}.png`,alt:a.name,className:"w-8 h-8 object-contain",loading:"lazy"}),e.jsx("span",{className:`font-semibold ${R(a.rarity)}`,children:a.name}),e.jsx("span",{className:"text-slate-400",children:"?"})]})}),!o&&p.length>0&&e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx(X,{count:_.length,label:"Available Recipes",variant:"green"}),e.jsx(Z,{value:d,onChange:m,placeholder:"Filter fusions...",variant:"green"})]})]}),e.jsxs("div",{className:"bg-slate-800/40 border border-slate-600/30 rounded-md p-4 flex flex-col gap-2 space-y-3 w-full max-w-lg",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-fuchsia-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-fuchsia-500 rounded-full"}),"Output Shard"]}),e.jsx(z,{value:P,onChange:F,onSelect:ne,onFocus:re,placeholder:"Search for an output shard to see recipes...",className:"w-full"})]}),t&&e.jsx("div",{className:"flex items-center justify-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-lg",children:[e.jsx("span",{className:"text-slate-300",children:"How to make"}),e.jsx("img",{src:`/SkyShards/shardIcons/${t.key}.png`,alt:t.name,className:"w-8 h-8 object-contain",loading:"lazy"}),e.jsx("span",{className:`font-semibold ${R(t.rarity)}`,children:t.name}),e.jsx("span",{className:"text-slate-400",children:"?"})]})}),!o&&E.length>0&&e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx(X,{count:V.length,label:"Available Recipes",variant:"fuchsia"}),e.jsx(Z,{value:q,onChange:se,placeholder:"Filter recipes...",variant:"fuchsia"})]})]})]}),a||t?e.jsxs("div",{className:"flex justify-center",children:[a&&!t&&!o&&p.length>0&&e.jsx("div",{className:"w-full max-w-7xl",children:e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-x-15 bg-slate-700/50 border border-slate-600/50 rounded-md p-3",children:_.sort((c,f)=>{var j,w,k,C;const y=["common","uncommon","rare","epic","legendary"],u=y.indexOf((((j=s.shards[c.output])==null?void 0:j.rarity)||"common").toLowerCase()),b=y.indexOf((((w=s.shards[f.output])==null?void 0:w.rarity)||"common").toLowerCase());if(u!==b)return u-b;const S=((k=s.shards[c.output])==null?void 0:k.name)||"",x=((C=s.shards[f.output])==null?void 0:C.name)||"";return S.localeCompare(x)}).map(c=>{const f=g[c.output]||c.partners[0],y=L.dropdownOpen[c.output]||!1;return e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0 min-h-[40px]",children:[e.jsx(N,{shardId:a.key,fusionData:s}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(J,{className:"w-5 h-5 text-purple-400",strokeWidth:2})}),e.jsx("div",{className:"flex items-center gap-2 min-w-0",children:c.partners.length>1?e.jsxs("div",{className:"relative flex-shrink-0",ref:u=>L.setRef(c.output,u),children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-2 py-2 text-slate-200 rounded shadow-sm border cursor-pointer bg-slate-800 border-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all duration-200",onClick:()=>L.toggleDropdown(c.output),tabIndex:0,children:[e.jsx(N,{shardId:f,fusionData:s,size:"sm"}),e.jsx(K,{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${y?"rotate-180":""}`})]}),y&&e.jsx("div",{className:"absolute z-20 top-full mt-1 left-0 bg-slate-900 border border-slate-600 rounded shadow-xl max-h-28 overflow-auto whitespace-nowrap",children:c.partners.map(u=>{var b,S,x,j,w;return e.jsxs("button",{type:"button",className:`w-full cursor-pointer flex items-center gap-1 px-2 py-2 text-sm hover:bg-slate-700 focus:bg-slate-700 transition-colors duration-150 ${u===f?"bg-slate-700 border-l-2 border-blue-400":"text-slate-200"}`,onClick:()=>{I(k=>$(O({},k),{[c.output]:u})),L.closeDropdown(c.output)},children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium w-8",children:["×",((b=s.shards[u])==null?void 0:b.fuse_amount)||2]}),e.jsx("img",{src:`/SkyShards/shardIcons/${u}.png`,alt:(S=s.shards[u])==null?void 0:S.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`text-sm truncate ${u===f?"text-blue-300":R(((x=s.shards[u])==null?void 0:x.rarity)||"common")}`,title:(j=s.shards[u])==null?void 0:j.name,children:(w=s.shards[u])==null?void 0:w.name})]},u)})})]}):e.jsx(N,{shardId:f,fusionData:s})}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"w-5 h-5 text-purple-400",strokeWidth:2})}),e.jsx(N,{shardId:c.output,quantity:c.quantities.get(f)||1,fusionData:s})]})},c.output)})})}),t&&!a&&!o&&E.length>0&&e.jsx("div",{className:"w-full max-w-7xl",children:e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-x-15 bg-slate-700/50 border border-slate-600/50 rounded-md p-3",children:V.map(([c,f],y)=>{const u=te[c]||0,b=f[u],S=D.dropdownOpen[c]||!1;return e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0 min-h-[40px]",children:[e.jsx(N,{shardId:c,fusionData:s}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(J,{className:"w-5 h-5 text-purple-400",strokeWidth:2})}),e.jsx("div",{className:"flex items-center gap-2 min-w-0",children:f.length>1?e.jsxs("div",{className:"relative flex-shrink-0",ref:x=>D.setRef(c,x),children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-2 py-2 text-slate-200 rounded shadow-sm border cursor-pointer bg-slate-800 border-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all duration-200",onClick:()=>D.toggleDropdown(c),tabIndex:0,children:[e.jsx(N,{shardId:b.input2,fusionData:s,size:"sm"}),e.jsx(K,{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${S?"rotate-180":""}`})]}),S&&e.jsx("div",{className:"absolute z-20 top-full mt-1 left-0 bg-slate-900 border border-slate-600 rounded shadow-xl max-h-28 overflow-auto whitespace-nowrap",children:f.map((x,j)=>{var w,k,C,Q,T;return e.jsxs("button",{type:"button",className:`w-full cursor-pointer flex items-center gap-1 px-2 py-2 text-sm hover:bg-slate-700 focus:bg-slate-700 transition-colors duration-150 ${j===u?"bg-slate-700 border-l-2 border-blue-400":"text-slate-200"}`,onClick:()=>{ae(oe=>$(O({},oe),{[c]:j})),D.closeDropdown(c)},children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium w-8",children:["×",((w=s.shards[x.input2])==null?void 0:w.fuse_amount)||2]}),e.jsx("img",{src:`/SkyShards/shardIcons/${x.input2}.png`,alt:(k=s.shards[x.input2])==null?void 0:k.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`text-sm truncate ${j===u?"text-blue-300":R(((C=s.shards[x.input2])==null?void 0:C.rarity)||"common")}`,title:(Q=s.shards[x.input2])==null?void 0:Q.name,children:(T=s.shards[x.input2])==null?void 0:T.name})]},`${x.input2}-${j}`)})})]}):e.jsx(N,{shardId:b.input2,fusionData:s})}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"w-5 h-5 text-purple-400",strokeWidth:2})}),e.jsx(N,{shardId:t.key,quantity:b.quantity,fusionData:s})]})},`${c}-${y}`)})})})]}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-slate-400 text-xl",children:"Select an input shard or output shard to see recipes"}),e.jsx("div",{className:"text-slate-500 text-sm mt-3",children:"Choose any shard in the left panel to see what you can create, or choose any shard in the right panel to see how to make it"})]}),!o&&a&&!t&&p.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-slate-400 text-lg",children:"No fusion recipes found using this shard."}),e.jsx("div",{className:"text-slate-500 text-sm mt-2",children:"This shard might not be used in any fusion recipes."})]}),!o&&t&&!a&&E.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-slate-400 text-lg",children:"No recipes found to create this shard."}),e.jsx("div",{className:"text-slate-500 text-sm mt-2",children:"This shard might be obtained directly or not fuseable."})]})]})})};export{Oe as default};
