var ce=Object.defineProperty,ie=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var Y=(a,n,t)=>n in a?ce(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,D=(a,n)=>{for(var t in n||(n={}))ue.call(n,t)&&Y(a,t,n[t]);if(H)for(var t of H(n))me.call(n,t)&&Y(a,t,n[t]);return a},L=(a,n)=>ie(a,de(n));var J=(a,n,t)=>new Promise((u,s)=>{var o=d=>{try{r(t.next(d))}catch(m){s(m)}},c=d=>{try{r(t.throw(d))}catch(m){s(m)}},r=d=>d.done?u(d.value):Promise.resolve(d.value).then(o,c);r((t=t.apply(a,n)).next())});import{j as e,b as z,i as xe}from"./index-DDm5AZNt.js";import{r as p}from"./vendor-Dt516RNf.js";import{S as q}from"./ShardAutocomplete-DJY2Ie3v.js";import{b as W,P as U,E as X}from"./icons-DNYyJ9Q2.js";import"./forms-CPIcrlzh.js";import"./dataService-CWMx40kF.js";const Z=({count:a,label:n,variant:t})=>{const u={green:"from-green-500/15 to-emerald-500/15 border-green-500/20 text-green-400",fuchsia:"from-fuchsia-500/15 to-pink-500/15 border-fuchsia-500/20 text-fuchsia-400"},s={green:"text-emerald-400",fuchsia:"text-pink-400"};return e.jsx("div",{className:`px-4 py-2 bg-gradient-to-r ${u[t]} rounded-md border`,children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:`font-medium ${u[t].split(" ")[3]}`,children:n}),e.jsx("span",{className:"text-slate-500",children:"•"}),e.jsx("span",{className:`font-semibold ${s[t]}`,children:a})]})})},G=({value:a,onChange:n,placeholder:t,variant:u})=>{const s={green:"focus:ring-green-500/50 focus:border-green-500/50",fuchsia:"focus:ring-fuchsia-500/50 focus:border-fuchsia-500/50"};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a,onChange:o=>n(o.target.value),placeholder:t,className:`w-64 pl-8 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 ${s[u]} hover:bg-slate-700/70 transition-colors`}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})},w=({shardId:a,quantity:n,fusionData:t,size:u="md"})=>{var r;const s=t.shards[a],o=(r=n!=null?n:s==null?void 0:s.fuse_amount)!=null?r:2,c=u==="sm"?"w-4 h-4":"w-5 h-5";return s?e.jsxs("div",{className:"flex items-center gap-1 lg:gap-2 xl:gap-3 min-w-0",children:[e.jsxs("span",{className:"text-xs lg:text-sm xl:text-base text-slate-400 font-medium flex-shrink-0",children:[o,"x"]}),e.jsx("img",{src:`/shardIcons/${a}.png`,alt:s.name,className:`${c} object-contain flex-shrink-0`,loading:"lazy"}),e.jsx("span",{className:`text-xs lg:text-sm xl:text-base font-medium truncate ${z(s.rarity)}`,title:s.name,children:s.name})]}):null},he=()=>{const[a,n]=p.useState(null),[t,u]=p.useState(!1);return p.useEffect(()=>{J(null,null,function*(){try{u(!0);const c=yield(yield fetch("/fusion-data.json")).json();n(c)}catch(o){console.error("Failed to load data:",o)}finally{u(!1)}})},[]),{fusionData:a,loading:t}},ee=()=>{const[a,n]=p.useState({}),t=p.useRef({});return p.useEffect(()=>{const c=r=>{const d=r.target;let m=!1;Object.entries(a).forEach(([f,O])=>{var I;O&&t.current[f]&&!((I=t.current[f])!=null&&I.contains(d))&&(m=!0)}),m&&n({})};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[a]),{dropdownOpen:a,toggleDropdown:c=>{n(r=>L(D({},r),{[c]:!r[c]}))},closeDropdown:c=>{n(r=>L(D({},r),{[c]:!1}))},setRef:(c,r)=>{t.current[c]=r}}},se=["common","uncommon","rare","epic","legendary"],pe=(a,n)=>{const t=new Map,u=new Set;Object.entries(n.recipes).forEach(([o,c])=>{Object.entries(c).forEach(([r,d])=>{const m=parseInt(r,10);d.forEach(f=>{if(f.length===2){const[O,I]=f;let N=null,$=null;if(O===a.key?(N=I,$="first"):I===a.key&&(N=O,$="second"),N&&$){const E=[a.key,N].sort(),F=`${E[0]}-${E[1]}-${o}`;if(u.has(F))return;u.add(F);const M=`${o}-${$}`;t.has(M)||t.set(M,{partners:new Set,quantities:new Map,positions:new Map});const C=t.get(M);C.partners.add(N),C.quantities.set(N,m),C.positions.set(N,$)}}})})});const s=[];return t.forEach((o,c)=>{var m;const r=c.split("-")[0],d=((m=n.shards[r])==null?void 0:m.fuse_amount)||2;s.push({output:r,fuseAmount:d,partners:Array.from(o.partners).sort(),quantities:o.quantities,positions:o.positions})}),s.sort((o,c)=>{const r=n.shards[o.output],d=n.shards[c.output],m=se.indexOf(((r==null?void 0:r.rarity)||"common").toLowerCase()),f=se.indexOf(((d==null?void 0:d.rarity)||"common").toLowerCase());return m!==f?m-f:((r==null?void 0:r.name)||"").localeCompare((d==null?void 0:d.name)||"")}),s},fe=(a,n)=>{const t=[];return Object.entries(n.recipes).forEach(([u,s])=>{u===a.key&&Object.entries(s).forEach(([o,c])=>{const r=parseInt(o,10);c.forEach(d=>{if(d.length===2){const[m,f]=d;t.push({input1:m,input2:f,quantity:r})}})})}),t},ge=(a,n,t)=>n.trim()?a.filter(u=>{const s=t.shards[u.output];return(s==null?void 0:s.name.toLowerCase().includes(n.toLowerCase()))||u.partners.some(o=>{var c;return(c=t.shards[o])==null?void 0:c.name.toLowerCase().includes(n.toLowerCase())})}):a,je=a=>{const n=new Map;return a.forEach(t=>{n.has(t.input1)||n.set(t.input1,[]),n.get(t.input1).push({input2:t.input2,quantity:t.quantity})}),n},be=(a,n,t)=>Array.from(a.entries()).filter(([u,s])=>{if(!n.trim())return!0;const o=t.shards[u];return(o==null?void 0:o.name.toLowerCase().includes(n.toLowerCase()))||s.some(c=>{var r;return(r=t.shards[c.input2])==null?void 0:r.name.toLowerCase().includes(n.toLowerCase())})}),Ce=()=>{const{selectedShard:a,setSelectedShard:n,selectedOutputShard:t,setSelectedOutputShard:u}=xe(),{fusionData:s,loading:o}=he(),[c,r]=p.useState(""),[d,m]=p.useState(""),[f,O]=p.useState([]),[I,N]=p.useState({}),[$,E]=p.useState(""),[F,M]=p.useState(""),[C,_]=p.useState([]),[te,ae]=p.useState({}),k=ee(),P=ee();p.useEffect(()=>{if(!a||!s){O([]);return}O(pe(a,s))},[a,s]),p.useEffect(()=>{if(!t||!s){_([]);return}_(fe(t,s))},[t,s]);const A=l=>{n(l),u(null),E("")},V=()=>{c&&r("")},ne=l=>{u(l),n(null),r(""),m("")},re=()=>{$&&E("")};if(o&&!s)return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"w-full border-b border-slate-700/30",children:e.jsx("div",{className:"px-4 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-full max-w-lg",children:e.jsx(q,{value:c,onChange:r,onSelect:A,onFocus:V,placeholder:"Search for a shard...",className:"w-full text-sm py-2 px-3",searchMode:"name-only"})})})})}),e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"w-8 h-8 border-2 border-purple-500/20 border-t-purple-500 rounded-full animate-spin"})})]});if(!s)return null;const Q=ge(f,d,s),le=je(C),T=be(le,F,s);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("div",{className:"px-2 sm:px-4 py-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-center gap-3 lg:gap-6 mb-4 lg:mb-6",children:[e.jsxs("div",{className:"bg-slate-800/40 border border-slate-600/30 rounded-md p-3 lg:p-4 flex flex-col gap-2 space-y-2 lg:space-y-3 w-full lg:max-w-lg",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-green-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Input Shard"]}),e.jsx(q,{value:c,onChange:r,onSelect:A,onFocus:V,placeholder:"Search for a shard...",className:"w-full",searchMode:"name-only"})]}),a&&e.jsx("div",{className:"flex items-center justify-center gap-2 lg:gap-3",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx("span",{className:"text-slate-300 text-sm",children:"What can you make with"}),e.jsx("img",{src:`/shardIcons/${a.key}.png`,alt:a.name,className:"w-5 h-5 object-contain",loading:"lazy"}),e.jsx("span",{className:`font-semibold text-sm ${z(a.rarity)}`,children:a.name}),e.jsx("span",{className:"text-slate-400 text-sm",children:"?"})]})}),!o&&f.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-2 lg:gap-4",children:[e.jsx(Z,{count:Q.length,label:"Available Recipes",variant:"green"}),e.jsx(G,{value:d,onChange:m,placeholder:"Filter fusions...",variant:"green"})]})]}),e.jsxs("div",{className:"bg-slate-800/40 border border-slate-600/30 rounded-md p-3 lg:p-4 flex flex-col gap-2 space-y-2 lg:space-y-3 w-full lg:max-w-lg",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-fuchsia-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-fuchsia-500 rounded-full"}),"Output Shard"]}),e.jsx(q,{value:$,onChange:E,onSelect:ne,onFocus:re,placeholder:"Search for a shard...",className:"w-full",searchMode:"name-only"})]}),t&&e.jsx("div",{className:"flex items-center justify-center gap-2 lg:gap-3",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx("span",{className:"text-slate-300 text-sm",children:"How to make"}),e.jsx("img",{src:`/shardIcons/${t.key}.png`,alt:t.name,className:"w-5 h-5 object-contain",loading:"lazy"}),e.jsx("span",{className:`font-semibold text-sm ${z(t.rarity)}`,children:t.name}),e.jsx("span",{className:"text-slate-400 text-sm",children:"?"})]})}),!o&&C.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-2 lg:gap-4",children:[e.jsx(Z,{count:T.length,label:"Available Recipes",variant:"fuchsia"}),e.jsx(G,{value:F,onChange:M,placeholder:"Filter recipes...",variant:"fuchsia"})]})]})]}),a||t?e.jsxs("div",{className:"flex justify-center",children:[a&&!t&&!o&&f.length>0&&e.jsx("div",{className:"w-full max-w-fit mx-auto",children:e.jsx("div",{className:"inline-grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-x-6 bg-slate-700/50 border border-slate-600/50 rounded-md p-2 lg:p-3",children:Q.sort((l,x)=>{var g,j,b,S;const R=["common","uncommon","rare","epic","legendary"],y=R.indexOf((((g=s.shards[l.output])==null?void 0:g.rarity)||"common").toLowerCase()),i=R.indexOf((((j=s.shards[x.output])==null?void 0:j.rarity)||"common").toLowerCase());if(y!==i)return y-i;const v=((b=s.shards[l.output])==null?void 0:b.name)||"",h=((S=s.shards[x.output])==null?void 0:S.name)||"";return v.localeCompare(h)}).map(l=>{const x=I[l.output]||l.partners[0],R=k.dropdownOpen[l.output]||!1,y=l.positions.get(x)||"first";return e.jsx("div",{className:"px-2",children:e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3 min-w-0 min-h-[40px]",children:[e.jsx("div",{className:"flex items-center gap-1 lg:gap-2 min-w-0 flex-shrink-0",children:y==="first"?e.jsx(w,{shardId:a.key,fusionData:s}):l.partners.length>1?e.jsxs("div",{className:"relative flex-shrink-0",ref:i=>k.setRef(l.output,i),children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 lg:gap-2 px-1 lg:px-2 py-1 lg:py-2 text-slate-200 rounded shadow-sm border cursor-pointer bg-slate-800 border-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all duration-200",onClick:()=>k.toggleDropdown(l.output),tabIndex:0,children:[e.jsx(w,{shardId:x,fusionData:s,size:"sm"}),e.jsx(W,{className:`w-3 h-3 text-slate-400 transition-transform duration-200 ${R?"rotate-180":""}`})]}),R&&e.jsx("div",{className:"absolute z-50 top-full mt-1 left-0 bg-slate-900 border border-slate-600 rounded shadow-xl max-h-40 overflow-auto min-w-max",children:l.partners.map(i=>{var v,h,g,j,b;return e.jsxs("button",{type:"button",className:`w-full cursor-pointer flex items-center gap-2 px-3 py-2 text-sm hover:bg-slate-700 focus:bg-slate-700 transition-colors duration-150 ${i===x?"bg-slate-700 border-l-2 border-blue-400":"text-slate-200"}`,onClick:()=>{N(S=>L(D({},S),{[l.output]:i})),k.closeDropdown(l.output)},children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium flex-shrink-0",children:["×",((v=s.shards[i])==null?void 0:v.fuse_amount)||2]}),e.jsx("img",{src:`/shardIcons/${i}.png`,alt:(h=s.shards[i])==null?void 0:h.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`text-sm flex-1 ${i===x?"text-blue-300":z(((g=s.shards[i])==null?void 0:g.rarity)||"common")}`,title:(j=s.shards[i])==null?void 0:j.name,children:(b=s.shards[i])==null?void 0:b.name})]},i)})})]}):e.jsx(w,{shardId:x,fusionData:s})}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx("div",{className:"flex items-center gap-1 lg:gap-2 min-w-0 flex-shrink-0",children:y==="second"?e.jsx(w,{shardId:a.key,fusionData:s}):l.partners.length>1?e.jsxs("div",{className:"relative flex-shrink-0",ref:i=>k.setRef(l.output+"-second",i),children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 lg:gap-2 px-1 lg:px-2 py-1 lg:py-2 text-slate-200 rounded shadow-sm border cursor-pointer bg-slate-800 border-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all duration-200",onClick:()=>k.toggleDropdown(l.output+"-second"),tabIndex:0,children:[e.jsx(w,{shardId:x,fusionData:s,size:"sm"}),e.jsx(W,{className:`w-3 h-3 text-slate-400 transition-transform duration-200 ${k.dropdownOpen[l.output+"-second"]?"rotate-180":""}`})]}),k.dropdownOpen[l.output+"-second"]&&e.jsx("div",{className:"absolute z-50 top-full mt-1 left-0 bg-slate-900 border border-slate-600 rounded shadow-xl max-h-40 overflow-auto min-w-max",children:l.partners.map(i=>{var v,h,g,j,b;return e.jsxs("button",{type:"button",className:`w-full cursor-pointer flex items-center gap-2 px-3 py-2 text-sm hover:bg-slate-700 focus:bg-slate-700 transition-colors duration-150 ${i===x?"bg-slate-700 border-l-2 border-blue-400":"text-slate-200"}`,onClick:()=>{N(S=>L(D({},S),{[l.output]:i})),k.closeDropdown(l.output+"-second")},children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium flex-shrink-0",children:["×",((v=s.shards[i])==null?void 0:v.fuse_amount)||2]}),e.jsx("img",{src:`/shardIcons/${i}.png`,alt:(h=s.shards[i])==null?void 0:h.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`text-sm flex-1 ${i===x?"text-blue-300":z(((g=s.shards[i])==null?void 0:g.rarity)||"common")}`,title:(j=s.shards[i])==null?void 0:j.name,children:(b=s.shards[i])==null?void 0:b.name})]},i)})})]}):e.jsx(w,{shardId:x,fusionData:s})}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(X,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx(w,{shardId:l.output,quantity:l.quantities.get(x)||1,fusionData:s})]})},`${l.output}-${y}`)})})}),t&&!a&&!o&&C.length>0&&e.jsx("div",{className:"w-full max-w-fit mx-auto",children:e.jsx("div",{className:"inline-grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-x-6 bg-slate-700/50 border border-slate-600/50 rounded-md p-2 lg:p-3",children:T.map(([l,x],R)=>{const y=te[l]||0,i=x[y],v=P.dropdownOpen[l]||!1;return e.jsx("div",{className:"px-2",children:e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3 min-w-0 min-h-[40px]",children:[e.jsx(w,{shardId:l,fusionData:s}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx("div",{className:"flex items-center gap-1 lg:gap-2 min-w-0 flex-shrink-0",children:x.length>1?e.jsxs("div",{className:"relative flex-shrink-0",ref:h=>P.setRef(l,h),children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 lg:gap-2 px-1 lg:px-2 py-1 lg:py-2 text-slate-200 rounded shadow-sm border cursor-pointer bg-slate-800 border-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all duration-200",onClick:()=>P.toggleDropdown(l),tabIndex:0,children:[e.jsx(w,{shardId:i.input2,fusionData:s,size:"sm"}),e.jsx(W,{className:`w-2 h-2 text-slate-400 transition-transform duration-200 ${v?"rotate-180":""}`})]}),v&&e.jsx("div",{className:"absolute z-50 top-full mt-1 left-0 bg-slate-900 border border-slate-600 rounded shadow-xl max-h-40 overflow-auto min-w-max",children:x.map((h,g)=>{var j,b,S,K,B;return e.jsxs("button",{type:"button",className:`w-full cursor-pointer flex items-center gap-2 px-3 py-2 text-sm hover:bg-slate-700 focus:bg-slate-700 transition-colors duration-150 ${g===y?"bg-slate-700 border-l-2 border-blue-400":"text-slate-200"}`,onClick:()=>{ae(oe=>L(D({},oe),{[l]:g})),P.closeDropdown(l)},children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium flex-shrink-0",children:["×",((j=s.shards[h.input2])==null?void 0:j.fuse_amount)||2]}),e.jsx("img",{src:`/shardIcons/${h.input2}.png`,alt:(b=s.shards[h.input2])==null?void 0:b.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`text-sm flex-1 ${g===y?"text-blue-300":z(((S=s.shards[h.input2])==null?void 0:S.rarity)||"common")}`,title:(K=s.shards[h.input2])==null?void 0:K.name,children:(B=s.shards[h.input2])==null?void 0:B.name})]},`${h.input2}-${g}`)})})]}):e.jsx(w,{shardId:i.input2,fusionData:s})}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(X,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx(w,{shardId:t.key,quantity:i.quantity,fusionData:s})]})},`${l}-${R}`)})})})]}):e.jsxs("div",{className:"text-center py-12 lg:py-20",children:[e.jsx("div",{className:"text-slate-400 text-lg lg:text-xl",children:"Select an input shard or output shard to see recipes"}),e.jsx("div",{className:"text-slate-500 text-xs lg:text-sm mt-2 lg:mt-3 px-4",children:"Choose any shard in the left panel to see what you can create, or choose any shard in the right panel to see how to make it"})]}),!o&&a&&!t&&f.length===0&&e.jsxs("div",{className:"text-center py-12 lg:py-16",children:[e.jsx("div",{className:"text-slate-400 text-base lg:text-lg",children:"No fusion recipes found using this shard."}),e.jsx("div",{className:"text-slate-500 text-xs lg:text-sm mt-2",children:"This shard might not be used in any fusion recipes."})]}),!o&&t&&!a&&C.length===0&&e.jsxs("div",{className:"text-center py-12 lg:py-16",children:[e.jsx("div",{className:"text-slate-400 text-base lg:text-lg",children:"No recipes found to create this shard."}),e.jsx("div",{className:"text-slate-500 text-xs lg:text-sm mt-2",children:"This shard might be obtained directly or not fuseable."})]})]})})};export{Ce as default};
