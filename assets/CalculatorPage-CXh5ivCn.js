var ue=Object.defineProperty,he=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var A=(r,s,t)=>s in r?ue(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,N=(r,s)=>{for(var t in s||(s={}))xe.call(s,t)&&A(r,t,s[t]);if(D)for(var t of D(s))pe.call(s,t)&&A(r,t,s[t]);return r},k=(r,s)=>he(r,me(s));var q=(r,s,t)=>A(r,typeof s!="symbol"?s+"":s,t);var S=(r,s,t)=>new Promise((n,l)=>{var i=c=>{try{d(t.next(c))}catch(u){l(u)}},a=c=>{try{d(t.throw(c))}catch(u){l(u)}},d=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,a);d((t=t.apply(r,s)).next())});import{u as J,j as e,_ as fe}from"./index-DcpfHFIw.js";import{r as p,R as $}from"./vendor-lM--12k9.js";import{o as H,s as B,a as X,b as G,c as K,n as j,e as be,d as Y,u as ve}from"./forms-DE1HYwwM.js";import{d as ge,D as _,g as T,M as P,K as M,f as R,a as ee,b as V,W as ye,N as we,B as U,u as je}from"./useCustomRates-BkE_1c7v.js";import{a as Ne,X as te,S as ke,Z as Se,R as Ce,b as I,c as Le,T as Te,d as Ee,H as Pe,e as Me,M as W,f as Re}from"./icons-D5G7fq2V.js";function se(r,s,t){var d;function n(c,u){var h,x;var o;Object.defineProperty(c,"_zod",{value:(h=c._zod)!=null?h:{},enumerable:!1}),(x=(o=c._zod).traits)!=null||(o.traits=new Set),c._zod.traits.add(r),s(c,u);for(const m in a.prototype)m in c||Object.defineProperty(c,m,{value:a.prototype[m].bind(c)});c._zod.constr=a,c._zod.def=u}const l=(d=t==null?void 0:t.Parent)!=null?d:Object;class i extends l{}Object.defineProperty(i,"name",{value:r});function a(c){var h;var u;const o=t!=null&&t.Parent?new i:this;n(o,c),(h=(u=o._zod).deferred)!=null||(u.deferred=[]);for(const x of o._zod.deferred)x();return o}return Object.defineProperty(a,"init",{value:n}),Object.defineProperty(a,Symbol.hasInstance,{value:c=>{var u,o;return t!=null&&t.Parent&&c instanceof t.Parent?!0:(o=(u=c==null?void 0:c._zod)==null?void 0:u.traits)==null?void 0:o.has(r)}}),Object.defineProperty(a,"name",{value:r}),a}class Oe extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const _e={};function re(r){return _e}function ze(r,s){return typeof s=="bigint"?s.toString():s}const ne=Error.captureStackTrace?Error.captureStackTrace:(...r)=>{};function O(r){return typeof r=="string"?r:r==null?void 0:r.message}function ae(r,s,t){var l,i,a,d,c,u,o,h,x,m,f;const n=k(N({},r),{path:(l=r.path)!=null?l:[]});if(!r.message){const b=(f=(m=(h=(u=O((d=(a=(i=r.inst)==null?void 0:i._zod.def)==null?void 0:a.error)==null?void 0:d.call(a,r)))!=null?u:O((c=s==null?void 0:s.error)==null?void 0:c.call(s,r)))!=null?h:O((o=t.customError)==null?void 0:o.call(t,r)))!=null?m:O((x=t.localeError)==null?void 0:x.call(t,r)))!=null?f:"Invalid input";n.message=b}return delete n.inst,delete n.continue,s!=null&&s.reportInput||delete n.input,n}const oe=(r,s)=>{r.name="$ZodError",Object.defineProperty(r,"_zod",{value:r._zod,enumerable:!1}),Object.defineProperty(r,"issues",{value:s,enumerable:!1}),Object.defineProperty(r,"message",{get(){return JSON.stringify(s,ze,2)},enumerable:!0})},$e=se("$ZodError",oe),le=se("$ZodError",oe,{Parent:Error}),Ae=r=>(s,t,n,l)=>{var d;const i=n?Object.assign(n,{async:!1}):{async:!1},a=s._zod.run({value:t,issues:[]},i);if(a instanceof Promise)throw new Oe;if(a.issues.length){const c=new((d=l==null?void 0:l.Err)!=null?d:r)(a.issues.map(u=>ae(u,i,re())));throw ne(c,l==null?void 0:l.callee),c}return a.value},Ke=Ae(le),Fe=r=>(s,t,n,l)=>S(null,null,function*(){var d;const i=n?Object.assign(n,{async:!0}):{async:!0};let a=s._zod.run({value:t,issues:[]},i);if(a instanceof Promise&&(a=yield a),a.issues.length){const c=new((d=l==null?void 0:l.Err)!=null?d:r)(a.issues.map(u=>ae(u,i,re())));throw ne(c,l==null?void 0:l.callee),c}return a.value}),Ie=Fe(le);function Z(r,s){try{var t=r()}catch(n){return s(n)}return t&&t.then?t.then(void 0,s):t}function Qe(r,s){for(var t={};r.length;){var n=r[0],l=n.code,i=n.message,a=n.path.join(".");if(!t[a])if("unionErrors"in n){var d=n.unionErrors[0].errors[0];t[a]={message:d.message,type:d.code}}else t[a]={message:i,type:l};if("unionErrors"in n&&n.unionErrors.forEach(function(o){return o.errors.forEach(function(h){return r.push(h)})}),s){var c=t[a].types,u=c&&c[n.code];t[a]=X(a,s,t,l,u?[].concat(u,n.message):n.message)}r.shift()}return t}function De(r,s){for(var t={};r.length;){var n=r[0],l=n.code,i=n.message,a=n.path.join(".");if(!t[a])if(n.code==="invalid_union"){var d=n.errors[0][0];t[a]={message:d.message,type:d.code}}else t[a]={message:i,type:l};if(n.code==="invalid_union"&&n.errors.forEach(function(o){return o.forEach(function(h){return r.push(h)})}),s){var c=t[a].types,u=c&&c[n.code];t[a]=X(a,s,t,l,u?[].concat(u,n.message):n.message)}r.shift()}return t}function qe(r,s,t){if(t===void 0&&(t={}),function(n){return"_def"in n&&typeof n._def=="object"&&"typeName"in n._def}(r))return function(n,l,i){try{return Promise.resolve(Z(function(){return Promise.resolve(r[t.mode==="sync"?"parse":"parseAsync"](n,s)).then(function(a){return i.shouldUseNativeValidation&&H({},i),{errors:{},values:t.raw?Object.assign({},n):a}})},function(a){if(function(d){return Array.isArray(d==null?void 0:d.issues)}(a))return{values:{},errors:B(Qe(a.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw a}))}catch(a){return Promise.reject(a)}};if(function(n){return"_zod"in n&&typeof n._zod=="object"}(r))return function(n,l,i){try{return Promise.resolve(Z(function(){return Promise.resolve((t.mode==="sync"?Ke:Ie)(r,n,s)).then(function(a){return i.shouldUseNativeValidation&&H({},i),{errors:{},values:t.raw?Object.assign({},n):a}})},function(a){if(function(d){return d instanceof $e}(a))return{values:{},errors:B(De(a.issues,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw a}))}catch(a){return Promise.reject(a)}};throw new Error("Invalid input: not a Zod schema")}const He=G({shard:Y().min(1,"Please select a shard"),quantity:j().min(1,"Quantity must be at least 1"),hunterFortune:j().min(0,"Hunter Fortune must be non-negative"),excludeChameleon:K(),frogPet:K(),newtLevel:j().min(0).max(10),salamanderLevel:j().min(0).max(10),lizardKingLevel:j().min(0).max(10),leviathanLevel:j().min(0).max(10),pythonLevel:j().min(0).max(10),kingCobraLevel:j().min(0).max(10),seaSerpentLevel:j().min(0).max(10),tiamatLevel:j().min(0).max(10),kuudraTier:be(["none","t1","t2","t3","t4","t5"]),moneyPerHour:j().min(0),noWoodenBait:K()});G({shardId:Y(),rate:j().min(0)});const Be=$.memo(({shard:r,index:s,focusedIndex:t,onSelect:n,isSelecting:l,setFocusedIndex:i})=>{const a=p.useCallback(c=>{c.preventDefault(),c.stopPropagation(),n(r)},[n,r]),d=p.useCallback(()=>{l||i(s)},[l,i,s]);return e.jsx("li",{className:`
        px-4 py-3 cursor-pointer transition-colors duration-200
        ${s===t?"bg-purple-500/20 border-l-2 border-purple-500":"hover:bg-white/5"}
        ${s!==t?"border-b border-white/5":""}
      `,onMouseDown:a,onClick:a,onMouseEnter:d,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:`font-medium ${T(r.rarity)}`,children:r.name}),e.jsxs("div",{className:"text-sm text-slate-400",children:[r.family," • ",r.type]})]}),r.rate>0&&e.jsxs("div",{className:"text-xs text-slate-500",children:[r.rate,"/hr"]})]})})}),Ve=({value:r,onChange:s,onSelect:t,placeholder:n="Search for a shard...",className:l=""})=>{const[i,a]=p.useState([]),[d,c]=p.useState(!1),[u,o]=p.useState(-1),[h,x]=p.useState(!1),m=p.useRef(null),f=p.useRef(null),b=p.useRef(null),{isUltraPerformanceMode:g}=J(),w=p.useMemo(()=>ge(v=>S(null,null,function*(){if(v.length===0||h){a([]),c(!1);return}try{const E=yield _.getInstance().searchShards(v);a(E.slice(0,10)),c(E.length>0),o(-1)}catch(y){console.error("Search failed:",y),a([]),c(!1)}}),200),[h]),Q=p.useCallback(v=>{const y=v.target.value;x(!1),s(y),b.current&&clearTimeout(b.current),w(y)},[s,w]),L=p.useCallback(v=>{x(!0),c(!1),a([]),o(-1),s(v.name),t(v),b.current&&clearTimeout(b.current),setTimeout(()=>{x(!1),m.current&&m.current.blur()},50)},[s,t]),ie=p.useCallback(v=>{if(!(!d||i.length===0||h))switch(v.key){case"ArrowDown":v.preventDefault(),o(y=>(y+1)%i.length);break;case"ArrowUp":v.preventDefault(),o(y=>y<=0?i.length-1:y-1);break;case"Enter":v.preventDefault(),u>=0&&u<i.length?L(i[u]):i.length===1&&L(i[0]);break;case"Escape":c(!1),o(-1);break}},[d,i,h,u,L]),ce=p.useCallback(()=>{var v;x(!1),s(""),a([]),c(!1),o(-1),b.current&&clearTimeout(b.current),(v=m.current)==null||v.focus()},[s]),de=p.useCallback(()=>{h||r&&i.length>0&&(i.some(y=>y.name.toLowerCase()===r.toLowerCase())||c(!0))},[h,r,i]);return p.useEffect(()=>{const v=y=>{const E=y.target;m.current&&!m.current.contains(E)&&f.current&&!f.current.contains(E)&&(c(!1),o(-1))};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v),b.current&&clearTimeout(b.current)}},[]),e.jsxs("div",{className:`relative ${l}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ne,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{ref:m,type:"text",value:r,onChange:Q,onKeyDown:ie,onFocus:de,placeholder:n,className:g?"w-full pl-10 pr-10 py-3 bg-slate-800 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 search-input":"w-full pl-10 pr-10 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50 transition-colors duration-200",autoComplete:"off",spellCheck:!1}),r&&e.jsx("button",{onClick:ce,className:g?"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-white":"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-white transition-colors duration-200",children:e.jsx(te,{className:"h-5 w-5"})})]}),d&&i.length>0&&!h&&e.jsx("ul",{ref:f,className:g?"absolute z-50 w-full mt-2 bg-slate-800 border border-slate-600 rounded max-h-64 overflow-y-auto autocomplete-dropdown":"absolute z-50 w-full mt-2 bg-slate-800/90 backdrop-blur-performance border border-white/10 rounded-xl shadow-2xl max-h-64 overflow-y-auto contain-paint",children:i.map((v,y)=>e.jsx(Be,{shard:v,index:y,focusedIndex:u,onSelect:L,isSelecting:h,setFocusedIndex:o},v.key))})]})},Ue=$.memo(({value:r,onChange:s,label:t,isUltraPerformance:n=!1})=>{const[l,i]=p.useState(!1),a=p.useMemo(()=>Array.from({length:11},(o,h)=>h),[]),d=p.useCallback(o=>{o.target.closest(".pet-level-dropdown")||i(!1)},[]);p.useEffect(()=>{if(l)return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[l,d]);const c=p.useCallback(()=>{n||i(!l)},[n]),u=p.useCallback(o=>{s(o),i(!1)},[s]);return n?e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-0.5",children:t}),e.jsx("select",{value:r,onChange:o=>s(Number(o.target.value)),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500",children:a.map(o=>e.jsxs("option",{value:o,children:["Level ",o]},o))})]}):e.jsxs("div",{className:"relative pet-level-dropdown",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-0.5",children:t}),e.jsxs("button",{type:"button",onClick:c,className:`
          w-full px-2 py-1.5 text-xs
          bg-white/5 backdrop-blur-performance
          border border-white/10 
          rounded-lg text-white
          focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
          hover:bg-white/10 transition-colors-only
          flex items-center justify-between
        `,children:[e.jsx("span",{children:r}),e.jsx(I,{className:`w-3 h-3 transition-transform duration-200 ${l?"rotate-180":""}`})]}),l&&e.jsx("div",{className:`
            absolute z-50 w-full mt-1
            bg-slate-800/95 backdrop-blur-performance
            border border-white/10 
            rounded-lg shadow-2xl
            max-h-48 overflow-y-auto
            contain-paint
          `,children:a.map(o=>e.jsxs("button",{type:"button",onClick:()=>u(o),className:`
                w-full px-2 py-1.5 text-xs text-left
                hover:bg-purple-500/20 transition-colors-only
                ${r===o?"bg-purple-500/30 text-purple-300":"text-white"}
                ${o!==a.length-1?"border-b border-white/5":""}
              `,children:["Level ",o]},o))})]})}),We=$.memo(({value:r,onChange:s,label:t})=>{const[n,l]=p.useState(!1),i=p.useCallback(u=>{u.target.closest(".kuudra-dropdown")||l(!1)},[]);p.useEffect(()=>{if(n)return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[n,i]);const a=p.useCallback(()=>l(!n),[]),d=p.useCallback(u=>{s(u),l(!1)},[s]),c=p.useMemo(()=>M.find(u=>u.value===r),[r]);return e.jsxs("div",{className:"relative kuudra-dropdown",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:t}),e.jsxs("button",{type:"button",onClick:a,className:`
          w-full px-2 py-1.5 text-sm
          bg-white/5 backdrop-blur-performance
          border border-white/10 
          rounded-lg text-white
          focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
          hover:bg-white/10 transition-colors-only
          flex items-center justify-between
        `,children:[e.jsx("span",{children:(c==null?void 0:c.label)||r}),e.jsx(I,{className:`w-3 h-3 transition-transform duration-200 ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:`
            absolute z-50 w-full mt-1
            bg-slate-800/95 backdrop-blur-performance
            border border-white/10 
            rounded-lg shadow-2xl
            max-h-48 overflow-y-auto
            contain-paint
          `,children:M.map(u=>e.jsx("button",{type:"button",onClick:()=>d(u.value),className:`
                w-full px-2 py-1.5 text-xs text-left
                hover:bg-purple-500/20 transition-colors-only
                ${r===u.value?"bg-purple-500/30 text-purple-300":"text-white"}
                ${u!==M[M.length-1]?"border-b border-white/5":""}
              `,children:u.label},u.value))})]})}),Ze=({onSubmit:r})=>{const{register:s,setValue:t,watch:n,reset:l,formState:{errors:i}}=ve({resolver:qe(He),defaultValues:{shard:"",quantity:1,hunterFortune:0,excludeChameleon:!1,frogPet:!1,newtLevel:0,salamanderLevel:0,lizardKingLevel:0,leviathanLevel:0,pythonLevel:0,kingCobraLevel:0,seaSerpentLevel:0,tiamatLevel:0,kuudraTier:"t5",moneyPerHour:0,noWoodenBait:!1}}),a=n("shard"),d=n(),{isUltraPerformanceMode:c}=J();p.useEffect(()=>{const m=f=>S(null,null,function*(){if(!f||f.trim()==="")return!1;try{return!!(yield _.getInstance().getShardNameToKeyMap())[f.toLowerCase()]}catch(b){return!1}});if(a&&a.trim()!==""&&d.shard&&d.shard.trim()!==""){const f=setTimeout(()=>S(null,null,function*(){if(yield m(d.shard)){const g=d,w=k(N({},g),{frogPet:!g.frogPet});r(w)}}),1e3);return()=>clearTimeout(f)}},[d,r,a]);const u=m=>{t("shard",m.name),setTimeout(()=>{const f=n(),b=k(N({},f),{shard:m.name,frogPet:!f.frogPet});r(b)},100)},o=()=>{t("hunterFortune",121),t("newtLevel",10),t("salamanderLevel",10),t("lizardKingLevel",10),t("leviathanLevel",10),t("pythonLevel",10),t("kingCobraLevel",10),t("seaSerpentLevel",10),t("tiamatLevel",10)},h=()=>{const m=n("shard"),f=n("quantity");l(),t("shard",m),t("quantity",f)},x=()=>S(null,null,function*(){const m=a;if(!m||m.trim()===""){t("quantity",P.common);return}try{const b=yield _.getInstance().getShardByName(m);if(b){const g=P[b.rarity]||P.common;t("quantity",g)}else t("quantity",P.common)}catch(f){console.error("Failed to get shard rarity:",f),t("quantity",P.common)}});return e.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-3",children:e.jsxs("form",{onSubmit:m=>m.preventDefault(),className:"space-y-3",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Target Shard"}),e.jsx(Ve,{value:a,onChange:m=>t("shard",m),onSelect:u,placeholder:"Search for a shard..."}),i.shard&&e.jsx("p",{className:"mt-1 text-xs text-red-400",children:i.shard.message})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Quantity"}),e.jsx("input",k(N({type:"number",min:"1"},s("quantity",{valueAsNumber:!0})),{onKeyDown:m=>{m.key==="Enter"&&(m.preventDefault(),m.currentTarget.blur())},className:`
                  w-full px-2 py-1.5 text-sm
                  bg-white/5 backdrop-blur-xl 
                  border border-white/10 
                  rounded-lg text-white placeholder-slate-400
                  focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                  transition-all duration-200
                `})),i.quantity&&e.jsx("p",{className:"mt-1 text-xs text-red-400",children:i.quantity.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:" "}),e.jsx("button",{type:"button",onClick:x,className:`
                    w-full h-[34px] text-sm bg-gradient-to-r from-blue-500 to-purple-500 
                    text-white font-medium rounded-lg flex items-center justify-center
                    hover:from-blue-600 hover:to-purple-600
                    transition-all duration-200 cursor-pointer
                    hover:scale-[1.02] active:scale-[0.98]
                  `,children:"Max"})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{className:"w-3 h-3 text-purple-400"}),e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Settings"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:o,className:`
                h-8 px-3 bg-gradient-to-r from-yellow-500 to-orange-500 
                text-white font-medium rounded-lg text-xs
                hover:from-yellow-600 hover:to-orange-600
                transition-all duration-200 flex items-center justify-center space-x-1 cursor-pointer
                hover:scale-[1.02] active:scale-[0.98]
              `,children:[e.jsx(Se,{className:"w-3 h-3"}),e.jsx("span",{children:"Max Stats"})]}),e.jsxs("button",{type:"button",onClick:h,className:`
                h-8 px-3 bg-gradient-to-r from-rose-500 to-pink-500 
                text-white font-medium rounded-lg text-xs
                hover:from-rose-600 hover:to-pink-600
                transition-all duration-200 flex items-center justify-center space-x-1 cursor-pointer
                hover:scale-[1.02] active:scale-[0.98]
              `,children:[e.jsx(Ce,{className:"w-3 h-3"}),e.jsx("span",{children:"Reset"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Hunter Fortune"}),e.jsx("input",k(N({type:"number",min:"0"},s("hunterFortune",{valueAsNumber:!0})),{onKeyDown:m=>{m.key==="Enter"&&(m.preventDefault(),m.currentTarget.blur())},className:`
                  w-full px-2 py-1.5 text-sm
                  bg-white/5 backdrop-blur-xl 
                  border border-white/10 
                  rounded-lg text-white placeholder-slate-400
                  focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                  transition-all duration-200
                `}))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 items-center space-x-2 p-2 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-all duration-200",children:[e.jsx("input",k(N({id:"excludeChameleon",type:"checkbox"},s("excludeChameleon")),{className:`
                    w-4 h-4 rounded-md bg-white/5 border-2 border-white/20 
                    text-purple-500 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500
                    transition-all duration-200 cursor-pointer
                    checked:bg-purple-500 checked:border-purple-500
                  `})),e.jsx("label",{htmlFor:"excludeChameleon",className:"text-xs font-medium text-white cursor-pointer flex-1",children:"Exclude Chameleon"})]}),e.jsxs("div",{className:"flex gap-2 items-center space-x-2 p-2 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-all duration-200",children:[e.jsx("input",k(N({id:"excludeWoodenBait",type:"checkbox"},s("noWoodenBait")),{className:`
                    w-4 h-4 rounded-md bg-white/5 border-2 border-white/20 
                    text-purple-500 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500
                    transition-all duration-200 cursor-pointer
                    checked:bg-purple-500 checked:border-purple-500
                  `})),e.jsx("label",{htmlFor:"excludeWoodenBait",className:"text-xs font-medium text-white cursor-pointer flex-1",children:"Exclude Wooden Bait"})]}),e.jsxs("div",{className:"flex gap-2 items-center space-x-2 p-2 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-all duration-200",children:[e.jsx("input",k(N({id:"frogPet",type:"checkbox"},s("frogPet")),{className:`
                    w-4 h-4 rounded-md bg-white/5 border-2 border-white/20 
                    text-purple-500 focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500
                    transition-all duration-200 cursor-pointer
                    checked:bg-purple-500 checked:border-purple-500
                  `})),e.jsx("label",{htmlFor:"frogPet",className:"text-xs font-medium text-white cursor-pointer flex-1",children:"No Frog Pet"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Shard Levels"}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:[{key:"newtLevel",label:"Newt"},{key:"salamanderLevel",label:"Salamander"},{key:"lizardKingLevel",label:"Lizard King"},{key:"leviathanLevel",label:"Leviathan"},{key:"pythonLevel",label:"Python"},{key:"kingCobraLevel",label:"King Cobra"},{key:"seaSerpentLevel",label:"Sea Serpent"},{key:"tiamatLevel",label:"Tiamat"}].map(({key:m,label:f})=>e.jsx(Ue,{value:n(m)||0,onChange:b=>t(m,b),label:f,isUltraPerformance:c},m))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Kraken Shard"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(We,{value:n("kuudraTier")||"t5",onChange:m=>t("kuudraTier",m),label:"Kuudra Tier"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-300 mb-1",children:"Coins/hour"}),e.jsx("input",k(N({type:"number",min:"0",placeholder:"40000000"},s("moneyPerHour",{valueAsNumber:!0})),{onKeyDown:m=>{m.key==="Enter"&&(m.preventDefault(),m.currentTarget.blur())},className:`
                  w-full px-2 py-1.5 text-sm
                  bg-white/5 backdrop-blur-xl 
                  border border-white/10 
                  rounded-lg text-white placeholder-slate-400
                  focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                  transition-all duration-200
                `})),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Empty to ignore key cost"})]})]})]})]})})},F=({tree:r,data:s,isTopLevel:t=!1,totalShardsProduced:n=r.quantity,nodeId:l,expandedStates:i,onToggle:a})=>{var f;const d=s.shards[r.shard],c=(f=i.get(l))!=null?f:!0;if(r.method==="direct")return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-slate-400",children:[r.quantity,"x"]}),e.jsx("span",{className:`font-medium cursor-help ${T(d.rarity)}`,title:V(d,!0),children:d.name}),e.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs font-medium rounded-full border border-green-500/30",children:"direct"})]})]}),e.jsxs("div",{className:"text-right flex flex-col items-end space-y-1",children:[e.jsxs("div",{className:"text-xs text-slate-400",children:[ee(d.rate),"/hour"]}),e.jsxs("div",{className:"text-xs text-slate-500 capitalize",children:[d.type," • ",d.family]})]})]});const u=r.inputs[0],o=r.inputs[1],h=s.shards[u.shard],x=s.shards[o.shard],m=t?n:r.quantity;return e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 overflow-hidden",children:[e.jsx("button",{onClick:()=>a(l),className:"w-full p-4 text-left hover:bg-white/5 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[c?e.jsx(I,{className:"w-5 h-5 text-slate-400"}):e.jsx(Me,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{className:"text-white",children:[e.jsxs("span",{className:"font-semibold",children:[m,"x "]}),e.jsx("span",{className:`font-medium cursor-help ${T(d.rarity)}`,title:V(d,!1),children:d.name}),e.jsxs("span",{className:"text-slate-400 ml-2",children:["= ",u.quantity,"x ",e.jsx("span",{className:T(h.rarity),children:h.name})," + ",o.quantity,"x"," ",e.jsx("span",{className:T(x.rarity),children:x.name})]})]})]}),e.jsxs("div",{className:"text-right flex flex-col items-end space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"fusions"}),e.jsx("span",{className:"text-sm font-medium text-white",children:m})]}),e.jsxs("div",{className:"text-xs text-slate-400 capitalize",children:[d.type," • ",d.family]})]})]})}),c&&e.jsxs("div",{className:"border-t border-white/10 p-4 space-y-3",children:[e.jsx(F,{tree:u,data:s,nodeId:`${l}-0`,expandedStates:i,onToggle:a}),e.jsx(F,{tree:o,data:s,nodeId:`${l}-1`,expandedStates:i,onToggle:a})]})]})},Je=({result:r,data:s,targetShardName:t})=>{const[n,l]=p.useState(new Map),[i,a]=p.useState(""),d=(o,h="root")=>{const x=new Map,m=(f,b)=>{f.method==="recipe"&&f.inputs&&(x.set(b,!0),f.inputs.forEach((g,w)=>{m(g,`${b}-${w}`)}))};return m(o,h),x};$.useEffect(()=>{if(r.tree){const o=JSON.stringify(r.tree);if(o!==i){const h=d(r.tree);l(h),a(o)}}},[r.tree,i]);const c=()=>{const o=new Map(n),h=Array.from(o.values()).every(x=>x);for(const x of o.keys())o.set(x,!h);l(o)},u=o=>{const h=new Map(n);h.set(o,!h.get(o)),l(h)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-purple-500/10 to-blue-500/10 backdrop-blur-xl border border-purple-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Le,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Time per Shard"}),e.jsx("p",{className:"text-white font-semibold",children:R(r.timePerShard)})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-500/10 to-cyan-500/10 backdrop-blur-xl border border-blue-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Te,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Total Time"}),e.jsx("p",{className:"text-white font-semibold",children:R(r.totalTime)})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500/10 to-emerald-500/10 backdrop-blur-xl border border-green-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Shards Produced"}),e.jsx("p",{className:"text-white font-semibold",children:r.totalShardsProduced})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/10 backdrop-blur-xl border border-orange-500/20 rounded-xl p-4 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Pe,{className:"w-5 h-5 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Total Fusions"}),e.jsxs("p",{className:"text-white font-semibold",children:[r.totalFusions,"x",r.craftTime>1/12&&e.jsx("span",{className:"text-xs text-slate-400 block",children:R(r.craftTime)})]})]})]})})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Materials Needed"}),e.jsxs("div",{className:"text-sm text-slate-400",children:["for ",r.totalShardsProduced," ",t," (",r.craftsNeeded," craft",r.craftsNeeded>1?"s":"",")"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Array.from(r.totalQuantities).map(([o,h])=>{const x=s.shards[o],m=h/x.rate;return e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3 hover:scale-[1.02] transition-transform duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[h,"x ",e.jsx("span",{className:T(x.rarity),children:x.name})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[ee(x.rate),"/hour"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-xs text-slate-400",children:R(m)})})]})},o)})})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Fusion Tree"}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors duration-200",children:Array.from(n.values()).every(o=>o)?"Collapse All":"Expand All"})]}),e.jsx(F,{tree:r.tree,data:s,isTopLevel:!0,totalShardsProduced:r.totalShardsProduced,nodeId:"root",expandedStates:n,onToggle:u})]})]})},C=class C{static getInstance(){return C.instance||(C.instance=new C),C.instance}parseData(s){return S(this,null,function*(){var t,n;try{const[l,i]=yield Promise.all([fetch("/SkyShards/fusion-data.json"),fetch("/SkyShards/rates.json")]),a=yield l.json(),d=yield i.json(),c={};for(const o in a.recipes){c[o]=[];for(const h in a.recipes[o]){const x=parseInt(h);a.recipes[o][h].forEach(f=>{c[o].push({inputs:f,outputQuantity:x})})}}const u={};for(const o in a.shards){let h=(n=(t=s.customRates[o])!=null?t:d[o])!=null?n:0;o==="L15"&&h===0&&(h=this.calculateKuudraRate(s.kuudraTier,s.moneyPerHour)),h>0&&(s.noWoodenBait&&ye.includes(o)&&(h*=.05),we.includes(o)||(h=this.applyFortuneModifiers(h,o,a.shards[o],s))),s.excludeChameleon&&o==="L4"&&(h=0),u[o]=k(N({},a.shards[o]),{id:o,rate:h})}return{recipes:c,shards:u}}catch(l){throw new Error(`Failed to parse data: ${l}`)}})}calculateKuudraRate(s,t){const l={t1:{baseTime:135,cost:155e3,multiplier:1},t2:{baseTime:135,cost:31e4,multiplier:1},t3:{baseTime:135,cost:582e3,multiplier:2},t4:{baseTime:135,cost:1164e3,multiplier:2},t5:{baseTime:165,cost:2328e3,multiplier:3}}[s];if(!l)return 0;const i=t===0?0:l.cost/t*3600;return l.multiplier*(3600/(l.baseTime+i))}applyFortuneModifiers(s,t,n,l){let i=l.hunterFortune;const a=1+5*l.tiamatLevel/100,d=1+2*l.seaSerpentLevel/100*a,c=2*l.pythonLevel/100*d,u=l.kingCobraLevel/100*d;switch(n.rarity){case"common":i+=2*l.newtLevel;break;case"uncommon":i+=2*l.salamanderLevel;break;case"rare":i+=l.lizardKingLevel;break;case"epic":i+=l.leviathanLevel;break}return l.frogPet&&(s*=1.1),t in U&&(U[t]&&(s*=1+c),i*=1+u),s*(1+i/100)}computeMinCosts(s){const t=new Map,n=new Map,l=Object.keys(s.shards);l.forEach(a=>{const d=s.shards[a].rate>0?1/s.shards[a].rate:1/0;t.set(a,d),n.set(a,{recipe:null})});let i=!0;for(;i;)i=!1,l.forEach(a=>{(s.recipes[a]||[]).forEach(c=>{const[u,o]=c.inputs,h=s.shards[u].fuse_amount,x=s.shards[o].fuse_amount,m=t.get(u)*h,f=t.get(o)*x,b=.8/3600,w=(m+f+b)/c.outputQuantity;w<t.get(a)&&(t.set(a,w),n.set(a,{recipe:c}),i=!0)})});return{minCosts:t,choices:n}}buildRecipeTree(s,t){const n=t.get(s);if(n.recipe===null)return{shard:s,method:"direct",quantity:0};{const l=n.recipe,[i,a]=l.inputs,d=this.buildRecipeTree(i,t),c=this.buildRecipeTree(a,t);return{shard:s,method:"recipe",recipe:l,inputs:[d,c],quantity:0}}}assignQuantities(s,t,n,l){if(s.quantity=t,s.method==="recipe"){const i=s.recipe,a=i.outputQuantity,d=Math.ceil(t/a);l.total+=d;const[c,u]=i.inputs,o=n.shards[c].fuse_amount,h=n.shards[u].fuse_amount,x=d*o,m=d*h;this.assignQuantities(s.inputs[0],x,n,l),this.assignQuantities(s.inputs[1],m,n,l)}}collectTotalQuantities(s){const t=new Map,n=l=>{if(l.method==="direct"){const i=t.get(l.shard)||0;t.set(l.shard,i+l.quantity)}else l.inputs.forEach(n)};return n(s),t}decimalHoursToHoursMinutes(s){const t=Math.floor(s),n=Math.round((s-t)*60);return t===0?`${n} minutes`:n===0||isNaN(n)?`${t} hours`:`${t} hours ${n} minutes`}calculateOptimalPath(s,t,n){return S(this,null,function*(){var g;const l=yield this.parseData(n);if(!l.shards[s])return{timePerShard:0,totalTime:0,totalShardsProduced:0,craftsNeeded:0,totalQuantities:new Map,totalFusions:0,craftTime:0,tree:{shard:s,method:"direct",quantity:0,inputs:[]}};const{minCosts:i,choices:a}=this.computeMinCosts(l),d=this.buildRecipeTree(s,a),c={total:0};this.assignQuantities(d,t,l,c);const u=this.collectTotalQuantities(d);let o=t,h=1;const x=a.get(s);if(x!=null&&x.recipe){const w=x.recipe.outputQuantity;h=Math.ceil(t/w),o=h*w}const m=(g=i.get(s))!=null?g:0,f=m*o,b=c.total*.8/3600;return{timePerShard:m,totalTime:f,totalShardsProduced:o,craftsNeeded:h,totalQuantities:u,totalFusions:c.total,craftTime:b,tree:d}})}};q(C,"instance");let z=C;const Xe=Object.freeze(Object.defineProperty({__proto__:null,CalculationService:z},Symbol.toStringTag,{value:"Module"})),Ge=()=>{const[r,s]=p.useState(null),[t,n]=p.useState(!1),[l,i]=p.useState(null),a=p.useCallback((c,u,o)=>S(null,null,function*(){try{n(!0),i(null);const x=yield z.getInstance().calculateOptimalPath(c,u,o);s(x)}catch(h){i(h instanceof Error?h.message:"Calculation failed"),s(null)}finally{n(!1)}}),[]),d=p.useCallback(()=>{s(null),i(null)},[]);return{result:r,loading:t,error:l,calculate:a,clearResult:d}},at=()=>{const{result:r,loading:s,error:t,calculate:n}=Ge(),{customRates:l}=je(),[i,a]=p.useState(null),[d,c]=p.useState(""),[u,o]=p.useState(!1),h=x=>S(null,null,function*(){try{if(!x.shard||x.shard.trim()===""){console.warn("Calculation skipped: No shard selected");return}o(!1);const b=(yield _.getInstance().getShardNameToKeyMap())[x.shard.toLowerCase()];if(!b){console.warn(`Calculation skipped: Shard "${x.shard}" not found in data`);return}c(x.shard);const g={customRates:l,hunterFortune:x.hunterFortune,excludeChameleon:x.excludeChameleon,frogPet:x.frogPet,newtLevel:x.newtLevel,salamanderLevel:x.salamanderLevel,lizardKingLevel:x.lizardKingLevel,leviathanLevel:x.leviathanLevel,pythonLevel:x.pythonLevel,kingCobraLevel:x.kingCobraLevel,seaSerpentLevel:x.seaSerpentLevel,tiamatLevel:x.tiamatLevel,kuudraTier:x.kuudraTier,moneyPerHour:x.moneyPerHour,noWoodenBait:x.noWoodenBait};yield n(b,x.quantity,g);const L=yield(yield fe(()=>Promise.resolve().then(()=>Xe),void 0)).CalculationService.getInstance().parseData(g);a(L)}catch(m){m instanceof Error&&!m.message.includes("not found")&&console.error("Calculation failed:",m)}});return e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 xl:gap-6 h-full",children:[e.jsx("div",{className:"xl:hidden",children:e.jsxs("button",{onClick:()=>o(!u),className:`
            mb-4 px-4 py-2 bg-white/5 backdrop-blur-xl 
            border border-white/10 rounded-xl text-white
            hover:bg-white/10 transition-all duration-200
            flex items-center space-x-2
            hover:scale-[1.02] active:scale-[0.98]
          `,children:[u?e.jsx(te,{className:"w-4 h-4"}):e.jsx(W,{className:"w-4 h-4"}),e.jsxs("span",{children:[u?"Hide":"Show"," Configuration"]})]})}),e.jsx("div",{className:`xl:w-80 2xl:w-96 xl:flex-shrink-0 ${u?"block":"hidden xl:block"}`,children:e.jsx("div",{children:e.jsx(Ze,{onSubmit:h})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[t&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4 flex items-center space-x-3 mb-6",children:[e.jsx(Re,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-400",children:"Calculation Error"}),e.jsx("p",{className:"text-red-300 text-sm",children:t})]})]}),r&&i&&e.jsx(Je,{result:r,data:i,targetShardName:d}),!r&&!s&&!t&&e.jsxs("div",{className:"text-center py-16 bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:"Ready to Calculate"}),e.jsxs("p",{className:"text-slate-400 max-w-md mx-auto",children:["Configure your settings ",e.jsx("span",{className:"xl:hidden",children:"above"}),e.jsx("span",{className:"hidden xl:inline",children:"on the left"})," and select a shard to see optimal fusion paths and material costs"]}),e.jsx("div",{className:"xl:hidden mt-4",children:e.jsxs("button",{onClick:()=>o(!0),className:`
                  px-6 py-3 bg-gradient-to-r from-purple-500 to-blue-600 
                  text-white font-medium rounded-xl 
                  hover:from-purple-600 hover:to-blue-700
                  transition-all duration-200
                  flex items-center space-x-2 mx-auto
                  hover:scale-[1.02] active:scale-[0.98]
                `,children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Open Configuration"})]})})]})]})]})};export{at as CalculatorPage};
