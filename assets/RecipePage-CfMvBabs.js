var ce=Object.defineProperty,ie=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var H=(n,a,t)=>a in n?ce(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,O=(n,a)=>{for(var t in a||(a={}))ue.call(a,t)&&H(n,t,a[t]);if(B)for(var t of B(a))me.call(a,t)&&H(n,t,a[t]);return n},$=(n,a)=>ie(n,de(a));var Y=(n,a,t)=>new Promise((i,s)=>{var o=d=>{try{l(t.next(d))}catch(m){s(m)}},r=d=>{try{l(t.throw(d))}catch(m){s(m)}},l=d=>d.done?i(d.value):Promise.resolve(d.value).then(o,r);l((t=t.apply(n,a)).next())});import{j as e,b as R,i as xe}from"./index-CIGqkUlD.js";import{r as x}from"./vendor-Dt516RNf.js";import{S as z}from"./ShardAutocomplete-o4OQ8MX4.js";import{P as J,b as K,E as U}from"./icons-DNYyJ9Q2.js";import"./forms-CPIcrlzh.js";import"./dataService-9TujrULY.js";const X=({count:n,label:a,variant:t})=>{const i={green:"from-green-500/15 to-emerald-500/15 border-green-500/20 text-green-400",fuchsia:"from-fuchsia-500/15 to-pink-500/15 border-fuchsia-500/20 text-fuchsia-400"},s={green:"text-emerald-400",fuchsia:"text-pink-400"};return e.jsx("div",{className:`px-4 py-2 bg-gradient-to-r ${i[t]} rounded-md border`,children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:`font-medium ${i[t].split(" ")[3]}`,children:a}),e.jsx("span",{className:"text-slate-500",children:"•"}),e.jsx("span",{className:`font-semibold ${s[t]}`,children:n})]})})},Z=({value:n,onChange:a,placeholder:t,variant:i})=>{const s={green:"focus:ring-green-500/50 focus:border-green-500/50",fuchsia:"focus:ring-fuchsia-500/50 focus:border-fuchsia-500/50"};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:n,onChange:o=>a(o.target.value),placeholder:t,className:`w-64 pl-8 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 ${s[i]} hover:bg-slate-700/70 transition-colors`}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})},w=({shardId:n,quantity:a,fusionData:t,size:i="md"})=>{var l;const s=t.shards[n],o=(l=a!=null?a:s==null?void 0:s.fuse_amount)!=null?l:2,r=i==="sm"?"w-4 h-4":"w-5 h-5";return s?e.jsxs("div",{className:"flex items-center gap-1 lg:gap-2 xl:gap-3 min-w-0",children:[e.jsxs("span",{className:"text-xs lg:text-sm xl:text-base text-slate-400 font-medium flex-shrink-0",children:[o,"x"]}),e.jsx("img",{src:`/SkyShards/shardIcons/${n}.png`,alt:s.name,className:`${r} object-contain flex-shrink-0`,loading:"lazy"}),e.jsx("span",{className:`text-xs lg:text-sm xl:text-base font-medium truncate ${R(s.rarity)}`,title:s.name,children:s.name})]}):null},he=()=>{const[n,a]=x.useState(null),[t,i]=x.useState(!1);return x.useEffect(()=>{Y(null,null,function*(){try{i(!0);const r=yield(yield fetch("/SkyShards/fusion-data.json")).json();a(r)}catch(o){console.error("Failed to load data:",o)}finally{i(!1)}})},[]),{fusionData:n,loading:t}},G=()=>{const[n,a]=x.useState({}),t=x.useRef({});return x.useEffect(()=>{const r=l=>{const d=l.target;let m=!1;Object.entries(n).forEach(([f,k])=>{var N;k&&t.current[f]&&!((N=t.current[f])!=null&&N.contains(d))&&(m=!0)}),m&&a({})};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[n]),{dropdownOpen:n,toggleDropdown:r=>{a(l=>$(O({},l),{[r]:!l[r]}))},closeDropdown:r=>{a(l=>$(O({},l),{[r]:!1}))},setRef:(r,l)=>{t.current[r]=l}}},ee=["common","uncommon","rare","epic","legendary"],pe=(n,a)=>{const t=new Map;Object.entries(a.recipes).forEach(([s,o])=>{Object.entries(o).forEach(([r,l])=>{const d=parseInt(r,10);l.forEach(m=>{if(m.length===2){const[f,k]=m;if(f===n.key){const N=k;t.has(s)||t.set(s,{partners:new Set,quantities:new Map});const I=t.get(s);I.partners.add(N),I.quantities.set(N,d)}}})})});const i=[];return t.forEach((s,o)=>{var l;const r=((l=a.shards[o])==null?void 0:l.fuse_amount)||2;i.push({output:o,fuseAmount:r,partners:Array.from(s.partners).sort(),quantities:s.quantities})}),i.sort((s,o)=>{const r=a.shards[s.output],l=a.shards[o.output],d=ee.indexOf(((r==null?void 0:r.rarity)||"common").toLowerCase()),m=ee.indexOf(((l==null?void 0:l.rarity)||"common").toLowerCase());return d!==m?d-m:((r==null?void 0:r.name)||"").localeCompare((l==null?void 0:l.name)||"")}),i},fe=(n,a)=>{const t=[];return Object.entries(a.recipes).forEach(([i,s])=>{i===n.key&&Object.entries(s).forEach(([o,r])=>{const l=parseInt(o,10);r.forEach(d=>{if(d.length===2){const[m,f]=d;t.push({input1:m,input2:f,quantity:l})}})})}),t},ge=(n,a,t)=>a.trim()?n.filter(i=>{const s=t.shards[i.output];return(s==null?void 0:s.name.toLowerCase().includes(a.toLowerCase()))||i.partners.some(o=>{var r;return(r=t.shards[o])==null?void 0:r.name.toLowerCase().includes(a.toLowerCase())})}):n,je=n=>{const a=new Map;return n.forEach(t=>{a.has(t.input1)||a.set(t.input1,[]),a.get(t.input1).push({input2:t.input2,quantity:t.quantity})}),a},be=(n,a,t)=>Array.from(n.entries()).filter(([i,s])=>{if(!a.trim())return!0;const o=t.shards[i];return(o==null?void 0:o.name.toLowerCase().includes(a.toLowerCase()))||s.some(r=>{var l;return(l=t.shards[r.input2])==null?void 0:l.name.toLowerCase().includes(a.toLowerCase())})}),Oe=()=>{const{selectedShard:n,setSelectedShard:a,selectedOutputShard:t,setSelectedOutputShard:i}=xe(),{fusionData:s,loading:o}=he(),[r,l]=x.useState(""),[d,m]=x.useState(""),[f,k]=x.useState([]),[N,I]=x.useState({}),[M,F]=x.useState(""),[P,se]=x.useState(""),[E,q]=x.useState([]),[te,ae]=x.useState({}),L=G(),D=G();x.useEffect(()=>{if(!n||!s){k([]);return}k(pe(n,s))},[n,s]),x.useEffect(()=>{if(!t||!s){q([]);return}q(fe(t,s))},[t,s]);const W=c=>{a(c),i(null),F("")},A=()=>{r&&l("")},ne=c=>{i(c),a(null),l(""),m("")},re=()=>{M&&F("")};if(o&&!s)return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"w-full border-b border-slate-700/30",children:e.jsx("div",{className:"px-4 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-full max-w-lg",children:e.jsx(z,{value:r,onChange:l,onSelect:W,onFocus:A,placeholder:"Search for a shard...",className:"w-full text-sm py-2 px-3",searchMode:"name-only"})})})})}),e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"w-8 h-8 border-2 border-purple-500/20 border-t-purple-500 rounded-full animate-spin"})})]});if(!s)return null;const _=ge(f,d,s),le=je(E),V=be(le,P,s);return e.jsx("div",{className:"min-h-screen",children:e.jsxs("div",{className:"px-2 sm:px-4 py-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-center gap-3 lg:gap-6 mb-4 lg:mb-6",children:[e.jsxs("div",{className:"bg-slate-800/40 border border-slate-600/30 rounded-md p-3 lg:p-4 flex flex-col gap-2 space-y-2 lg:space-y-3 w-full lg:max-w-lg",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-green-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Input Shard"]}),e.jsx(z,{value:r,onChange:l,onSelect:W,onFocus:A,placeholder:"Search for a shard...",className:"w-full",searchMode:"name-only"})]}),n&&e.jsx("div",{className:"flex items-center justify-center gap-2 lg:gap-3",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx("span",{className:"text-slate-300 text-sm",children:"What can you make with"}),e.jsx("img",{src:`/SkyShards/shardIcons/${n.key}.png`,alt:n.name,className:"w-5 h-5 object-contain",loading:"lazy"}),e.jsx("span",{className:`font-semibold text-sm ${R(n.rarity)}`,children:n.name}),e.jsx("span",{className:"text-slate-400 text-sm",children:"?"})]})}),!o&&f.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-2 lg:gap-4",children:[e.jsx(X,{count:_.length,label:"Available Recipes",variant:"green"}),e.jsx(Z,{value:d,onChange:m,placeholder:"Filter fusions...",variant:"green"})]})]}),e.jsxs("div",{className:"bg-slate-800/40 border border-slate-600/30 rounded-md p-3 lg:p-4 flex flex-col gap-2 space-y-2 lg:space-y-3 w-full lg:max-w-lg",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-fuchsia-300 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-fuchsia-500 rounded-full"}),"Output Shard"]}),e.jsx(z,{value:M,onChange:F,onSelect:ne,onFocus:re,placeholder:"Search for a shard...",className:"w-full",searchMode:"name-only"})]}),t&&e.jsx("div",{className:"flex items-center justify-center gap-2 lg:gap-3",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx("span",{className:"text-slate-300 text-sm",children:"How to make"}),e.jsx("img",{src:`/SkyShards/shardIcons/${t.key}.png`,alt:t.name,className:"w-5 h-5 object-contain",loading:"lazy"}),e.jsx("span",{className:`font-semibold text-sm ${R(t.rarity)}`,children:t.name}),e.jsx("span",{className:"text-slate-400 text-sm",children:"?"})]})}),!o&&E.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-2 lg:gap-4",children:[e.jsx(X,{count:V.length,label:"Available Recipes",variant:"fuchsia"}),e.jsx(Z,{value:P,onChange:se,placeholder:"Filter recipes...",variant:"fuchsia"})]})]})]}),n||t?e.jsxs("div",{className:"flex justify-center",children:[n&&!t&&!o&&f.length>0&&e.jsx("div",{className:"w-full max-w-fit mx-auto",children:e.jsx("div",{className:"inline-grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-x-6 bg-slate-700/50 border border-slate-600/50 rounded-md p-2 lg:p-3",children:_.sort((c,p)=>{var g,b,S,C;const y=["common","uncommon","rare","epic","legendary"],u=y.indexOf((((g=s.shards[c.output])==null?void 0:g.rarity)||"common").toLowerCase()),j=y.indexOf((((b=s.shards[p.output])==null?void 0:b.rarity)||"common").toLowerCase());if(u!==j)return u-j;const v=((S=s.shards[c.output])==null?void 0:S.name)||"",h=((C=s.shards[p.output])==null?void 0:C.name)||"";return v.localeCompare(h)}).map(c=>{const p=N[c.output]||c.partners[0],y=L.dropdownOpen[c.output]||!1;return e.jsx("div",{className:"px-2",children:e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3 min-w-0 min-h-[40px]",children:[e.jsx(w,{shardId:n.key,fusionData:s}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(J,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx("div",{className:"flex items-center gap-1 lg:gap-2 min-w-0 flex-shrink-0",children:c.partners.length>1?e.jsxs("div",{className:"relative flex-shrink-0",ref:u=>L.setRef(c.output,u),children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 lg:gap-2 px-1 lg:px-2 py-1 lg:py-2 text-slate-200 rounded shadow-sm border cursor-pointer bg-slate-800 border-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all duration-200",onClick:()=>L.toggleDropdown(c.output),tabIndex:0,children:[e.jsx(w,{shardId:p,fusionData:s,size:"sm"}),e.jsx(K,{className:`w-3 h-3 text-slate-400 transition-transform duration-200 ${y?"rotate-180":""}`})]}),y&&e.jsx("div",{className:"absolute z-50 top-full mt-1 left-0 bg-slate-900 border border-slate-600 rounded shadow-xl max-h-40 overflow-auto min-w-max",children:c.partners.map(u=>{var j,v,h,g,b;return e.jsxs("button",{type:"button",className:`w-full cursor-pointer flex items-center gap-2 px-3 py-2 text-sm hover:bg-slate-700 focus:bg-slate-700 transition-colors duration-150 ${u===p?"bg-slate-700 border-l-2 border-blue-400":"text-slate-200"}`,onClick:()=>{I(S=>$(O({},S),{[c.output]:u})),L.closeDropdown(c.output)},children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium flex-shrink-0",children:["×",((j=s.shards[u])==null?void 0:j.fuse_amount)||2]}),e.jsx("img",{src:`/SkyShards/shardIcons/${u}.png`,alt:(v=s.shards[u])==null?void 0:v.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`text-sm flex-1 ${u===p?"text-blue-300":R(((h=s.shards[u])==null?void 0:h.rarity)||"common")}`,title:(g=s.shards[u])==null?void 0:g.name,children:(b=s.shards[u])==null?void 0:b.name})]},u)})})]}):e.jsx(w,{shardId:p,fusionData:s})}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx(w,{shardId:c.output,quantity:c.quantities.get(p)||1,fusionData:s})]})},c.output)})})}),t&&!n&&!o&&E.length>0&&e.jsx("div",{className:"w-full max-w-fit mx-auto",children:e.jsx("div",{className:"inline-grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-x-6 bg-slate-700/50 border border-slate-600/50 rounded-md p-2 lg:p-3",children:V.map(([c,p],y)=>{const u=te[c]||0,j=p[u],v=D.dropdownOpen[c]||!1;return e.jsx("div",{className:"px-2",children:e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3 min-w-0 min-h-[40px]",children:[e.jsx(w,{shardId:c,fusionData:s}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(J,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx("div",{className:"flex items-center gap-1 lg:gap-2 min-w-0 flex-shrink-0",children:p.length>1?e.jsxs("div",{className:"relative flex-shrink-0",ref:h=>D.setRef(c,h),children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 lg:gap-2 px-1 lg:px-2 py-1 lg:py-2 text-slate-200 rounded shadow-sm border cursor-pointer bg-slate-800 border-slate-700 hover:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all duration-200",onClick:()=>D.toggleDropdown(c),tabIndex:0,children:[e.jsx(w,{shardId:j.input2,fusionData:s,size:"sm"}),e.jsx(K,{className:`w-2 h-2 text-slate-400 transition-transform duration-200 ${v?"rotate-180":""}`})]}),v&&e.jsx("div",{className:"absolute z-50 top-full mt-1 left-0 bg-slate-900 border border-slate-600 rounded shadow-xl max-h-40 overflow-auto min-w-max",children:p.map((h,g)=>{var b,S,C,Q,T;return e.jsxs("button",{type:"button",className:`w-full cursor-pointer flex items-center gap-2 px-3 py-2 text-sm hover:bg-slate-700 focus:bg-slate-700 transition-colors duration-150 ${g===u?"bg-slate-700 border-l-2 border-blue-400":"text-slate-200"}`,onClick:()=>{ae(oe=>$(O({},oe),{[c]:g})),D.closeDropdown(c)},children:[e.jsxs("span",{className:"text-sm text-slate-400 font-medium flex-shrink-0",children:["×",((b=s.shards[h.input2])==null?void 0:b.fuse_amount)||2]}),e.jsx("img",{src:`/SkyShards/shardIcons/${h.input2}.png`,alt:(S=s.shards[h.input2])==null?void 0:S.name,className:"w-5 h-5 object-contain flex-shrink-0",loading:"lazy"}),e.jsx("span",{className:`text-sm flex-1 ${g===u?"text-blue-300":R(((C=s.shards[h.input2])==null?void 0:C.rarity)||"common")}`,title:(Q=s.shards[h.input2])==null?void 0:Q.name,children:(T=s.shards[h.input2])==null?void 0:T.name})]},`${h.input2}-${g}`)})})]}):e.jsx(w,{shardId:j.input2,fusionData:s})}),e.jsx("div",{className:"flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"w-3 h-3 text-purple-400",strokeWidth:2})}),e.jsx(w,{shardId:t.key,quantity:j.quantity,fusionData:s})]})},`${c}-${y}`)})})})]}):e.jsxs("div",{className:"text-center py-12 lg:py-20",children:[e.jsx("div",{className:"text-slate-400 text-lg lg:text-xl",children:"Select an input shard or output shard to see recipes"}),e.jsx("div",{className:"text-slate-500 text-xs lg:text-sm mt-2 lg:mt-3 px-4",children:"Choose any shard in the left panel to see what you can create, or choose any shard in the right panel to see how to make it"})]}),!o&&n&&!t&&f.length===0&&e.jsxs("div",{className:"text-center py-12 lg:py-16",children:[e.jsx("div",{className:"text-slate-400 text-base lg:text-lg",children:"No fusion recipes found using this shard."}),e.jsx("div",{className:"text-slate-500 text-xs lg:text-sm mt-2",children:"This shard might not be used in any fusion recipes."})]}),!o&&t&&!n&&E.length===0&&e.jsxs("div",{className:"text-center py-12 lg:py-16",children:[e.jsx("div",{className:"text-slate-400 text-base lg:text-lg",children:"No recipes found to create this shard."}),e.jsx("div",{className:"text-slate-500 text-xs lg:text-sm mt-2",children:"This shard might be obtained directly or not fuseable."})]})]})})};export{Oe as default};
