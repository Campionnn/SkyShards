var A=Object.defineProperty,O=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var R=(r,a,s)=>a in r?A(r,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[a]=s,D=(r,a)=>{for(var s in a||(a={}))W.call(a,s)&&R(r,s,a[s]);if(k)for(var s of k(a))X.call(a,s)&&R(r,s,a[s]);return r},F=(r,a)=>O(r,V(a));var I=(r,a,s)=>new Promise((m,h)=>{var c=l=>{try{i(s.next(l))}catch(d){h(d)}},p=l=>{try{i(s.throw(l))}catch(d){h(d)}},i=l=>l.done?m(l.value):Promise.resolve(l.value).then(c,p);i((s=s.apply(r,a)).next())});import{j as e,e as q,b as G,d as J,R as K,h as Q,i as U,f as Y}from"./index-DFf8J8P1.js";import{r as n,R as E}from"./vendor-e8ACzjHW.js";import{D as Z,u as ee,S as te}from"./useCustomRates-BQl1zBdX.js";import{b as se,R as re,h as ae}from"./icons-DR3cHNnz.js";import"./forms-B7jjzPDX.js";const T={common:"bg-gray-700/80 border-gray-500/80",uncommon:"bg-green-400/10 border-green-400/20",rare:"bg-blue-400/10 border-blue-400/20",epic:"bg-purple-500/10 border-purple-500/20",legendary:"bg-yellow-400/10 border-yellow-400/20"},le=({open:r,onClose:a,title:s,name:m,description:h,rarity:c,icon:p,rate:i,onRateChange:l,isDirect:d,family:x,type:f})=>{const[v,b]=n.useState("");E.useEffect(()=>{r&&b("")},[r]),E.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]);const o=u=>{if(b(u.target.value),l){const j=parseFloat(u.target.value);u.target.value===""?l(void 0):isNaN(j)||l(j)}};if(!r)return null;const y=u=>{u.target===u.currentTarget&&a()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/65",onClick:y,children:e.jsxs("div",{className:`bg-slate-900 border ${q(c)} rounded-xl shadow-2xl px-10 py-8 min-w-[500px]  max-w-[700px] relative animate-fadeIn`,onClick:u=>u.stopPropagation(),children:[e.jsx("button",{onClick:a,className:"absolute top-0 right-2 text-2xl text-slate-500 cursor-pointer",children:"√ó"}),e.jsxs("div",{className:"flex items-center gap-10",children:[e.jsx("img",{src:p,alt:s,className:"w-32 h-32 object-contain flex-shrink-0 shadow-lg"}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0 justify-center",children:[e.jsxs("div",{className:"text-xl font-bold text-white mb-0.5 truncate flex gap-2",children:[m,e.jsx("span",{className:`space-x-2 px-1.5 py-1 font-medium uppercase tracking-wider text-xs ${G(c)} ${T[c]||T.common} border rounded-md self-start`,children:c})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"text-sm text-yellow-500 font-medium truncate",children:[s," I-X"]}),x&&f&&e.jsxs("span",{className:"text-xs text-slate-400",children:[x," ‚Ä¢ ",f]})]}),e.jsx("p",{className:"text-slate-300 text-base leading-snug break-words max-w-xl my-3",dangerouslySetInnerHTML:{__html:h}}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[typeof d=="boolean"&&(d?e.jsx("span",{className:"px-1.5 py-1 text-xs bg-green-500/20 text-green-400 border border-green-500/30 rounded-md font-medium mr",children:"Direct"}):e.jsx("span",{className:"px-1.5 py-1 text-xs bg-fuchsia-500/20 text-fuchsia-400 border border-fuchsia-500/30 rounded-md font-medium",children:"Fuse"})),e.jsx("input",{type:"number",min:"0",step:"0.01",value:v,onChange:o,placeholder:typeof i=="number"?i.toString():"",className:"px-1 h-6.5 w-15 py-1 text-sm text-center bg-white/5 border border-white/10 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-purple-500/50 focus:border-purple-500/50 transition-colors duration-200"}),e.jsx("span",{className:"text-sm text-slate-400",children:"rate / hr"})]})]})]})]})})},ne=()=>{const[r,a]=n.useState([]),[s,m]=n.useState(!0),[h,c]=n.useState(null);return n.useEffect(()=>{I(null,null,function*(){try{m(!0);const i=Z.getInstance(),[l,d]=yield Promise.all([i.loadShards(),i.loadDefaultRates()]),x=l.map(f=>F(D({},f),{rate:d[f.key]||0,isDirect:(d[f.key]||0)>0}));a(x),c(null)}catch(i){c(i instanceof Error?i.message:"Failed to load shards and recipes")}finally{m(!1)}})},[]),{shards:r,loading:s,error:h}},xe=()=>{console.log("SettingsPage rendered");const{shards:r,loading:a}=ne(),{customRates:s,defaultRates:m,updateRate:h,resetRates:c}=ee(),[p,i]=n.useState(""),[l,d]=n.useState("all"),[x,f]=n.useState("all"),[v,b]=n.useState(!1),[o,y]=n.useState(null),[u,j]=n.useState(""),S=n.useMemo(()=>J(t=>j(t),300),[]);n.useEffect(()=>{S(p)},[p,S]);const N=n.useMemo(()=>r.filter(t=>{const g=u.toLowerCase(),w=t.name.toLowerCase().includes(g),B=t.family.toLowerCase().includes(g),H=t.type.toLowerCase().includes(g),M=w||B||H,_=l==="all"||t.rarity===l,z=x==="all"||x==="direct"&&t.isDirect||x==="fuse"&&!t.isDirect;return M&&_&&z}),[r,u,l,x]),C=n.useCallback((t,g)=>{h(t,g),b(!0)},[h]),L=n.useCallback(()=>{confirm("Are you sure you want to reset all rates to their defaults? This will clear all custom rates.")&&(c(),b(!1))},[c]),P=n.useCallback(()=>{b(!1)},[]),$=n.useCallback(t=>{i(t.target.value)},[]);return a?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"w-8 h-8 border-2 border-purple-500/20 border-t-purple-500 rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-screen flex flex-col space-y-4 py-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent mb-2",children:"Custom Shard Rates"}),e.jsx("p",{className:"text-slate-400",children:"Customize gathering rates for more accurate calculations"})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-md p-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(se,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:"text",value:p,onChange:$,onFocus:()=>i(""),placeholder:"Search shards...",className:`
                w-full pl-10 pr-4 py-2.5 
                bg-white/5 border border-white/10 
                rounded-md text-white placeholder-slate-400
                focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                transition-colors duration-200
              `})]}),e.jsx(K,{value:l,onChange:d}),e.jsx(Q,{value:x,onChange:f}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:L,className:`
                px-3 py-2.5 bg-red-500/20 hover:bg-red-500/30 
                text-red-400 font-medium rounded-md 
                border border-red-500/20 hover:border-red-500/30
                transition-colors duration-200
                flex items-center space-x-2 cursor-pointer
              `,children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Reset"})]}),v&&e.jsxs("button",{onClick:P,className:`
                  px-3 py-2.5 bg-green-500/20 hover:bg-green-500/30 
                  text-green-400 font-medium rounded-md 
                  border border-green-500/20 hover:border-green-500/30
                  transition-colors duration-200
                  flex items-center space-x-2 cursor-pointer
                `,children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Save"})]})]})]}),e.jsx("div",{className:"mt-3 text-sm text-slate-400",children:e.jsxs("p",{children:["Base rates (shards/hour) ‚Ä¢ Showing ",N.length," of ",r.length," shards"]})})]}),e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-md overflow-hidden flex-1",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-2 p-3",children:N.map(t=>e.jsx("div",{children:e.jsx(U,{shard:t,rate:s[t.key]!==void 0?s[t.key]:m[t.key],defaultRate:m[t.key],onRateChange:C,onCardClick:()=>y(t)})},t.key))})})}),o&&(()=>{const t=te[o.key],g=`/SkyShards/shardIcons/${o.key}.png`;return e.jsx(le,{open:!!o,onClose:()=>y(null),title:(t==null?void 0:t.title)||o.name,name:o.name,description:Y((t==null?void 0:t.description)||"No description."),rarity:o.rarity,icon:g,rate:s[o.key]!==void 0?s[o.key]:m[o.key],onRateChange:w=>C(o.key,w),isDirect:o.isDirect,family:o.family,type:o.type})})(),N.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üîç"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Shards Found"}),e.jsx("p",{className:"text-slate-400",children:"Try adjusting your search or filter criteria"})]})]})};export{xe as SettingsPage};
