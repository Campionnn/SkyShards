var T=Object.defineProperty,A=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var N=(r,n,s)=>n in r?T(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s,C=(r,n)=>{for(var s in n||(n={}))I.call(n,s)&&N(r,s,n[s]);if(y)for(var s of y(n))z.call(n,s)&&N(r,s,n[s]);return r},S=(r,n)=>A(r,B(n));var R=(r,n,s)=>new Promise((i,o)=>{var p=a=>{try{d(s.next(a))}catch(x){o(x)}},m=a=>{try{d(s.throw(a))}catch(x){o(x)}},d=a=>a.done?i(a.value):Promise.resolve(a.value).then(p,m);d((s=s.apply(r,n)).next())});import{j as e}from"./index-CBrQdnpH.js";import{r as l,R as w,e as k}from"./vendor-lM--12k9.js";import{D as W,u as X,d as Y,g as H}from"./useCustomRates-CRvHpbg-.js";import{a as U,R as q,g as G,F as J,d as D,L as K}from"./icons-ub95DieP.js";const Q=()=>{const[r,n]=l.useState([]),[s,i]=l.useState(!0),[o,p]=l.useState(null);return l.useEffect(()=>{R(null,null,function*(){try{i(!0);const d=W.getInstance(),[a,x]=yield Promise.all([d.loadShards(),d.loadDefaultRates()]),c=a.map(t=>S(C({},t),{rate:x[t.key]||0,isDirect:(x[t.key]||0)>0}));n(c),p(null)}catch(d){p(d instanceof Error?d.message:"Failed to load shards and recipes")}finally{i(!1)}})},[]),{shards:r,loading:s,error:o}},V=w.memo(({value:r,onChange:n})=>{const[s,i]=l.useState(!1),[o,p]=l.useState(null),[m,d]=l.useState({top:0,left:0,width:0}),a=l.useMemo(()=>[{value:"all",label:"All Rarities"},{value:"common",label:"Common"},{value:"uncommon",label:"Uncommon"},{value:"rare",label:"Rare"},{value:"epic",label:"Epic"},{value:"legendary",label:"Legendary"}],[]),x=l.useCallback(()=>{if(s&&o){const t=o.getBoundingClientRect();d({top:t.bottom+window.scrollY+4,left:t.left+window.scrollX,width:t.width})}},[s,o]);l.useEffect(x,[x]),l.useEffect(()=>{const t=f=>{const h=f.target;!h.closest(".rarity-dropdown")&&!h.closest(".dropdown-portal")&&i(!1)};if(s)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[s]);const c=l.useMemo(()=>a.find(t=>t.value===r),[a,r]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative rarity-dropdown",children:e.jsxs("button",{ref:p,type:"button",onClick:()=>i(!s),className:`
            flex items-center justify-between space-x-2 px-3 py-2.5 min-w-[140px]
            bg-purple-500/10 border border-purple-500/20 hover:border-purple-400/30
            rounded-xl text-white hover:bg-purple-500/20 
            transition-colors duration-200
          `,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"w-5 h-5 text-purple-400"}),e.jsx("span",{className:"font-medium",children:(c==null?void 0:c.label)||"All Rarities"})]}),e.jsx(D,{className:`w-4 h-4 text-purple-400 transition-transform duration-200 ${s?"rotate-180":""}`})]})}),s&&k.createPortal(e.jsx("div",{className:"dropdown-portal fixed z-[9999] bg-slate-800/95 backdrop-blur-sm border border-purple-500/20 rounded-xl shadow-2xl",style:{top:m.top,left:m.left,width:Math.max(m.width,140)},children:a.map(t=>e.jsx("button",{type:"button",onClick:()=>{n(t.value),i(!1)},className:`
                  w-full px-4 py-3 text-sm text-left font-medium
                  hover:bg-purple-500/20 transition-colors duration-200
                  ${r===t.value?"bg-purple-500/30 text-purple-200":"text-white hover:text-purple-200"}
                  ${t!==a[a.length-1]?"border-b border-purple-500/10":""}
                  ${t===a[0]?"rounded-t-xl":""}
                  ${t===a[a.length-1]?"rounded-b-xl":""}
                `,children:t.label},t.value))}),document.body)]})}),Z=w.memo(({value:r,onChange:n})=>{const[s,i]=l.useState(!1),[o,p]=l.useState(null),[m,d]=l.useState({top:0,left:0,width:0}),a=l.useMemo(()=>[{value:"all",label:"All Types"},{value:"direct",label:"Direct"},{value:"fuse",label:"Fuse"}],[]),x=l.useCallback(()=>{if(s&&o){const t=o.getBoundingClientRect();d({top:t.bottom+window.scrollY+4,left:t.left+window.scrollX,width:t.width})}},[s,o]);l.useEffect(x,[x]),l.useEffect(()=>{const t=f=>{const h=f.target;!h.closest(".type-dropdown")&&!h.closest(".type-dropdown-portal")&&i(!1)};if(s)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[s]);const c=l.useMemo(()=>a.find(t=>t.value===r),[a,r]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative type-dropdown",children:e.jsxs("button",{ref:p,type:"button",onClick:()=>i(!s),className:`
            flex items-center justify-between space-x-2 px-3 py-2.5 min-w-[140px]
            bg-emerald-500/10 border border-emerald-500/20 hover:border-emerald-400/30
            rounded-xl text-white hover:bg-emerald-500/20
            transition-colors duration-200
          `,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-5 h-5 text-emerald-400"}),e.jsx("span",{className:"font-medium",children:(c==null?void 0:c.label)||"All Types"})]}),e.jsx(D,{className:`w-4 h-4 text-emerald-400 transition-transform duration-200 ${s?"rotate-180":""}`})]})}),s&&k.createPortal(e.jsx("div",{className:"type-dropdown-portal fixed z-[9999] bg-slate-800/95 backdrop-blur-sm border border-emerald-500/20 rounded-xl shadow-2xl",style:{top:m.top,left:m.left,width:Math.max(m.width,140)},children:a.map(t=>e.jsx("button",{type:"button",onClick:()=>{n(t.value),i(!1)},className:`
                  w-full px-4 py-3 text-sm text-left font-medium
                  hover:bg-emerald-500/20 transition-colors duration-200
                  ${r===t.value?"bg-emerald-500/30 text-emerald-200":"text-white hover:text-emerald-200"}
                  ${t!==a[a.length-1]?"border-b border-emerald-500/10":""}
                  ${t===a[0]?"rounded-t-xl":""}
                  ${t===a[a.length-1]?"rounded-b-xl":""}
                `,children:t.label},t.value))}),document.body)]})}),_=w.memo(({shard:r,rate:n,onRateChange:s})=>{const i=l.useCallback(o=>{s(r.key,parseFloat(o.target.value)||0)},[r.key,s]);return e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3 hover:bg-white/10 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("div",{className:`font-medium text-sm ${H(r.rarity)} truncate`,children:r.name}),r.isDirect?e.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-green-500/20 text-green-400 border border-green-500/30 rounded-full flex-shrink-0",children:"Direct"}):e.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-fuchsia-500/20 text-fuchsia-400 border border-fuchsia-500/30 rounded-full flex-shrink-0",children:"Fuse"})]}),e.jsxs("div",{className:"text-xs text-slate-400 truncate",children:[r.type," â€¢ ",r.family]})]}),e.jsx("div",{className:"w-20 ml-2",children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:n,onChange:i,className:`
              w-full px-2 py-1.5 text-sm text-center
              bg-white/5 border border-white/10 rounded-lg
              text-white placeholder-slate-400
              focus:outline-none focus:ring-1 focus:ring-purple-500/50 focus:border-purple-500/50
              transition-colors duration-200
            `})})]})})}),ae=()=>{const{shards:r,loading:n}=Q(),{customRates:s,defaultRates:i,updateRate:o,resetRates:p}=X(),[m,d]=l.useState(""),[a,x]=l.useState("all"),[c,t]=l.useState("all"),[f,h]=l.useState(!1),[v,F]=l.useState(""),j=l.useMemo(()=>Y(u=>F(u),300),[]);l.useEffect(()=>{j(m)},[m,j]);const b=l.useMemo(()=>r.filter(u=>{const g=u.name.toLowerCase().includes(v.toLowerCase()),M=a==="all"||u.rarity===a,O=c==="all"||c==="direct"&&u.isDirect||c==="fuse"&&!u.isDirect;return g&&M&&O}),[r,v,a,c]),E=l.useCallback((u,g)=>{o(u,g),h(!0)},[o]),L=l.useCallback(()=>{confirm("Are you sure you want to reset all rates to their defaults? This will clear all custom rates.")&&(p(),h(!1))},[p]),$=l.useCallback(()=>{h(!1)},[]),P=l.useCallback(u=>{d(u.target.value)},[]);return n?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"w-8 h-8 border-2 border-purple-500/20 border-t-purple-500 rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-screen flex flex-col space-y-4 py-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent mb-2",children:"Custom Shard Rates"}),e.jsx("p",{className:"text-slate-400",children:"Customize gathering rates for more accurate calculations"})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(U,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:"text",value:m,onChange:P,placeholder:"Search shards...",className:`
                w-full pl-10 pr-4 py-2.5 
                bg-white/5 border border-white/10 
                rounded-xl text-white placeholder-slate-400
                focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500/50
                transition-colors duration-200
              `})]}),e.jsx(V,{value:a,onChange:x}),e.jsx(Z,{value:c,onChange:t}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:L,className:`
                px-3 py-2.5 bg-red-500/20 hover:bg-red-500/30 
                text-red-400 font-medium rounded-xl 
                border border-red-500/20 hover:border-red-500/30
                transition-colors duration-200
                flex items-center space-x-2
              `,children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"Reset"})]}),f&&e.jsxs("button",{onClick:$,className:`
                  px-3 py-2.5 bg-green-500/20 hover:bg-green-500/30 
                  text-green-400 font-medium rounded-xl 
                  border border-green-500/20 hover:border-green-500/30
                  transition-colors duration-200
                  flex items-center space-x-2
                `,children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Save"})]})]})]}),e.jsx("div",{className:"mt-3 text-sm text-slate-400",children:e.jsxs("p",{children:["Base rates (shards/hour) â€¢ Showing ",b.length," of ",r.length," shards"]})})]}),e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl overflow-hidden flex-1",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-2 p-3",children:b.map(u=>e.jsx(_,{shard:u,rate:s[u.key]||i[u.key]||0,onRateChange:E},u.key))})})}),b.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Shards Found"}),e.jsx("p",{className:"text-slate-400",children:"Try adjusting your search or filter criteria"})]})]})};export{ae as SettingsPage};
